(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    121994,       2587]
NotebookOptionsPosition[    120037,       2517]
NotebookOutlinePosition[    120385,       2532]
CellTagsIndexPosition[    120342,       2529]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorData", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
    "Import", "[", 
     "\"\<C:\\\\ETH\\\\Neuro\\\\GlobalTracking\\\\GlobalTrackingScripts\\\\\
tensor_data.txt\>\"", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"dim", "=", 
  RowBox[{"Dimensions", "[", "TensorData", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Tensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "6"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6376408711401596`*^9, 3.63764090944243*^9}, {
  3.637642223442727*^9, 3.637642224035528*^9}, {3.637642588013631*^9, 
  3.6376425897452335`*^9}, {3.6376427209040656`*^9, 3.6376427701155524`*^9}, {
  3.6376428653375206`*^9, 3.637642901132984*^9}, {3.6376430845609083`*^9, 
  3.6376431307283897`*^9}, {3.6376431863066874`*^9, 3.6376431866342883`*^9}, {
  3.6376436659501348`*^9, 3.637643671285344*^9}, {3.638016044529835*^9, 
  3.6380160579776044`*^9}, {3.638022352874652*^9, 3.638022357140896*^9}, {
  3.638026101989089*^9, 3.6380261058433094`*^9}, {3.6380295187905188`*^9, 
  3.638029591439674*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9", ",", "9", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6386947448877144`*^9, 3.6387265492276173`*^9, 
  3.6387691619472556`*^9, 3.638778407116049*^9, 3.6387840076943836`*^9, 
  3.638846436643702*^9, 3.6388481010602264`*^9, 3.638848734984867*^9, 
  3.638869857688972*^9, 3.6388705145905256`*^9, 3.638870866995145*^9, 
  3.639234454604957*^9, 3.6392440159317846`*^9, 3.6392826506447225`*^9, 
  3.6392857231432467`*^9, 3.639292521978692*^9, 3.639300656656495*^9, 
  3.639303123335764*^9, 3.6395721901988707`*^9, 3.6396274410391636`*^9, 
  3.6398431781115456`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", "vec_", "]"}], ":=", 
   RowBox[{"{", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "   ", 
     ",", "   ", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "   ", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SurfacePositions", " ", "=", " ", 
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.639300281210635*^9, 
   3.6393003142982936`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.6392936406098566`*^9, 3.6392936450558643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"E0init_", ",", "\[Alpha]maxinit_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]max", " ", "=", " ", "\[Alpha]maxinit"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"E0", " ", "=", "E0init"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Surface", " ", "=", " ", 
     RowBox[{"Select", "[", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
        "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"S", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"S", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "Pi"}]}], "}"}], "]"}], ",", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "*)"}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<tensor\>\"", "->", 
               RowBox[{"Tensor", "[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<direction\>\"", "->", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
               RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "1"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kk", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<forward\>\"", "->", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<backward\>\"", "->", 
               RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"A", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<tensor\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<direction\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<forward\>\"", "->", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<backward\>\"", "->", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.6393002972786636`*^9, 
   3.6393002976218643`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neighborhood Functions", "Subsection",
 CellChangeTimes->{{3.6392936149010115`*^9, 3.639293620953822*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], 
            "-", 
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
             "]"}]}], ")"}], ".", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          ">", "0"}], "  ", "&&", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<forward\>\"", "]"}], 
           "\[Equal]", 
           RowBox[{"{", "}"}]}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<backward\>\"", "]"}], 
           "\[Equal]", 
           RowBox[{"{", "}"}]}]}], ")"}]}], " ", ")"}], "&"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", "spin_", "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        "<=", "0"}], "  ", "&&", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<forward\>\"", "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<backward\>\"", "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}]}], ")"}]}], " ", ")"}], "&"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.6398443286998634`*^9, 3.639844339209879*^9}, {3.6398444385530224`*^9, 
   3.6398445005721197`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flip Fiber", "Subsection",
 CellChangeTimes->{{3.6398445795662346`*^9, 3.6398445822762384`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Flip", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "dir_"}], "]"}], ":=", " ", "Null"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flip", "[", 
   RowBox[{"spin_", ",", "dir_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"forward", ",", "backward"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"forward", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"backward", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dir", " ", "==", " ", "\"\<forwards\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         " ", "*=", " ", 
         RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", "  ", "forward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flip", "[", 
         RowBox[{"forward", ",", "\"\<forwards\>\""}], "]"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         " ", "*=", " ", 
         RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", "  ", "backward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flip", "[", 
         RowBox[{"backward", ",", " ", "\"\<backwards\>\""}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.639844586056244*^9, 3.639844648651334*^9}, 
   3.639844755664709*^9, {3.6398452962920184`*^9, 3.639845492115301*^9}, {
   3.6398455758334312`*^9, 3.6398457245966454`*^9}, {3.6399304877523537`*^9, 
   3.6399305023933754`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Functions", "Subsection",
 CellChangeTimes->{{3.6392936023897896`*^9, 3.6392936060245957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"backward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"backward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "backward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "backward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"forward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "forward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "forward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], " ", "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], " ", "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"Surface", ",", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["E0", "2."], " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"E0", "*", 
             RowBox[{"Log", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"cos\[Alpha]", "-", 
                   RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                  RowBox[{"1", "-", 
                   RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
                ",", 
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "6"}]}]}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"E0", " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"E0", "*", 
             RowBox[{"Log", "[", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"cos\[Alpha]", "-", 
                   RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                  RowBox[{"1", "-", 
                   RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
                ",", 
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "6"}]}]}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"spin1_", ",", "spin2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"connection", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin1", "]"}], "[", "\"\<position\>\"", "]"}], 
        "-", 
        RowBox[{
         RowBox[{"A", "[", "spin2", "]"}], "[", "\"\<position\>\"", "]"}]}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"COS\[Alpha]", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"connection", ".", 
           RowBox[{
            RowBox[{"A", "[", "spin1", "]"}], "[", "\"\<direction\>\"", 
            "]"}]}], "/", 
          RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"COS\[Alpha]", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"connection", ".", 
           RowBox[{
            RowBox[{"A", "[", "spin2", "]"}], "[", "\"\<direction\>\"", 
            "]"}]}], "/", 
          RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"cos\[Alpha]", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], ",", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"cos\[Alpha]", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], "]"}]}], ",", 
          "\[Infinity]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Edata", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Tinv", ",", "norm"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tinv", " ", "=", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<tensor\>\"", "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{
        FractionBox["2", 
         RowBox[{"\[Pi]", "^", "2"}]], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Tinv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"Tinv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"Tinv", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
        ".", "Tinv", ".", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
       "/", "norm"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.63929410027643*^9, 3.639294147497713*^9}, {3.6392945813968754`*^9, 
   3.6392946417221813`*^9}, {3.639296628969*^9, 3.639296632198206*^9}, {
   3.6393001043219247`*^9, 3.639300134679578*^9}, {3.63963101986337*^9, 
   3.6396310289737864`*^9}, {3.639634116825578*^9, 3.639634309236316*^9}, 
   3.6396344003872766`*^9, 3.639843287514705*^9, {3.639931351329856*^9, 
   3.6399313665488777`*^9}, {3.6399323124692636`*^9, 
   3.6399323215042763`*^9}, {3.639932362387344*^9, 3.6399323980913954`*^9}, {
   3.6399324362894497`*^9, 3.6399324822995176`*^9}, {3.639932725504877*^9, 
   3.639932775578949*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create New Spin", "Subsection",
 CellChangeTimes->{{3.639293662886696*^9, 3.6392936685651054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateNew", "[", 
   RowBox[{"str_", ",", "spin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newposition", ",", "newforward", ",", "newbackward", ",", "newID"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"str", " ", "\[Equal]", " ", "\"\<forward\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "+", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "->", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", "spin"}]}], "}"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"newforward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
           " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newforward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newforward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newforward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
         "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "\[Rule]", "spin"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", 
                 RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"newbackward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
           " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newbackward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newbackward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newbackward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392954013625145`*^9, 3.639295402984917*^9}, {
   3.6393002043337*^9, 3.639300208124507*^9}, {3.6393002499637804`*^9, 
   3.639300267217411*^9}, {3.6393003300543213`*^9, 3.639300367509987*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Associate Spin", "Subsection",
 CellChangeTimes->{{3.6392936975499563`*^9, 3.6392937056307707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Associate", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"oldforward", ",", "oldbackward", ",", 
      RowBox[{"forwardneighbors", "=", 
       RowBox[{"{", "}"}]}], ",", "backwardneighbors", ",", 
      RowBox[{"minforward", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"minbackward", "=", 
       RowBox[{"{", "}"}]}], ",", "E0", ",", "E1", ",", "Emin"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"forwardneighbors", " ", "=", " ", 
      RowBox[{"F", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"forwardneighbors", " ", "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Emin", " ", "=", 
         RowBox[{"10", "^", "10"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"E0", " ", "=", " ", 
            RowBox[{"Eint", "[", 
             RowBox[{"spin", ",", "newforward"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"E0", "<", "Emin"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Emin", " ", "=", " ", "E0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"minforward", " ", "=", " ", "newforward"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"newforward", ",", "forwardneighbors"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"minforward", "==", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CreateNew", "[", 
            RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", "minforward", "]"}], "[", "\"\<backward\>\"", 
              "]"}], " ", "\[Equal]", " ", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}],
               " ", "=", " ", "minforward"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "minforward", "]"}], "[", "\"\<backward\>\"",
                "]"}], " ", "=", " ", "spin"}], ";"}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flip", "[", 
              RowBox[{"minforward", ",", "\"\<forwards\>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}],
               " ", "=", " ", "minforward"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "minforward", "]"}], "[", "\"\<backward\>\"",
                "]"}], " ", "=", " ", "spin"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "==="}], "="}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"backwardneighbors", " ", "=", " ", 
      RowBox[{"B", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"backwardneighbors", " ", "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Emin", " ", "=", 
         RowBox[{"10", "^", "10"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"E0", " ", "=", " ", 
            RowBox[{"Eint", "[", 
             RowBox[{"spin", ",", "newbackward"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"E0", "<", "Emin"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Emin", " ", "=", " ", "E0"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"minbackward", " ", "=", " ", "newbackward"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"newforward", ",", "backwardneighbors"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"minbackward", "==", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CreateNew", "[", 
            RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"A", "[", "minbackward", "]"}], "[", "\"\<forward\>\"", 
              "]"}], " ", "\[Equal]", " ", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
               "]"}], " ", "=", " ", "minbackward"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "minbackward", "]"}], "[", "\"\<forward\>\"",
                "]"}], " ", "=", " ", "spin"}], ";"}], "\[IndentingNewLine]", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flip", "[", 
              RowBox[{"minbackward", ",", "\"\<backwards\>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
               "]"}], " ", "=", " ", "minbackward"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "minbackward", "]"}], "[", "\"\<forward\>\"",
                "]"}], " ", "=", " ", "spin"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.639295315733964*^9, 3.639295323128377*^9}, {
   3.6392953553112335`*^9, 3.6392953706460605`*^9}, {3.6392964505982866`*^9, 
   3.639296515712801*^9}, {3.6392965903433323`*^9, 3.639296615053776*^9}, {
   3.639932497651539*^9, 3.6399326269917264`*^9}, {3.6399328488350554`*^9, 
   3.639933063637415*^9}, {3.639933178781581*^9, 3.639933307378768*^9}, {
   3.6399333460218325`*^9, 3.6399334659800034`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Align Spin", "Subsection",
 CellChangeTimes->{{3.639293712900384*^9, 3.639293715380788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Align", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newdirection", ",", "olddirection", ",", "E0", ",", "E1", ",", "p"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"olddirection", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newdirection", " ", "=", "  ", 
      RowBox[{"olddirection", " ", "+", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "3"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newdirection", "=", 
      RowBox[{"newdirection", "/", 
       RowBox[{"Norm", "[", "newdirection", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], "=", 
      "newdirection"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ">", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         "=", "olddirection"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392953793196754`*^9, 3.639295386402088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 CellChangeTimes->{{3.6392937224788003`*^9, 3.6392937236644025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Energy", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"1.", ",", 
    RowBox[{"Pi", "/", "3."}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "n", ",", "s", ",", 
     RowBox[{"N", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "\[LessEqual]", "N"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Energy", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"Energy", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Eint", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}], "+", 
             RowBox[{"Edata", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "2"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "2"}], ",", 
              RowBox[{"k", "<", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Associate", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "<=", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Align", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "}"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6387265850926685`*^9, 3.6387266182545652`*^9}, {
   3.6387266547656536`*^9, 3.638726730015958*^9}, {3.638726767279089*^9, 
   3.6387268341269126`*^9}, {3.638728996310582*^9, 3.638728998703719*^9}, {
   3.638774777993475*^9, 3.638774796595539*^9}, 3.6387758845047636`*^9, {
   3.6387765618485055`*^9, 3.6387765648386765`*^9}, {3.6387766067520742`*^9, 
   3.6387766089281983`*^9}, {3.6387767545385265`*^9, 3.638776780083988*^9}, {
   3.638776871456214*^9, 3.6387768987137733`*^9}, {3.6387769612843523`*^9, 
   3.6387769751051426`*^9}, {3.6387770351615777`*^9, 
   3.6387770446761217`*^9}, {3.638780724314585*^9, 3.6387808244323115`*^9}, {
   3.6387808660246906`*^9, 3.6387808743601675`*^9}, {3.6387811093806095`*^9, 
   3.6387811422604904`*^9}, {3.6387813280711184`*^9, 
   3.6387814042754765`*^9}, {3.638781445752849*^9, 3.638781497681819*^9}, {
   3.638781740086684*^9, 3.6387818031062884`*^9}, {3.6387818667979317`*^9, 
   3.638781870587148*^9}, 3.6387820216447883`*^9, {3.638782085824459*^9, 
   3.638782089326659*^9}, {3.6387831847253127`*^9, 3.6387832302659173`*^9}, {
   3.638783265513933*^9, 3.6387833131676593`*^9}, 3.638783569945346*^9, {
   3.6387836932844005`*^9, 3.638783694868491*^9}, {3.6387861824447727`*^9, 
   3.6387861925063477`*^9}, {3.6387867726195283`*^9, 3.638786775172674*^9}, {
   3.6388464914933987`*^9, 3.6388465005414143`*^9}, {3.638846557481514*^9, 
   3.638846576731948*^9}, 3.6388468052063503`*^9, 3.638846942658191*^9, {
   3.6388470085215073`*^9, 3.638847011345112*^9}, {3.6388471927422304`*^9, 
   3.638847229917096*^9}, 3.638847460469901*^9, 3.638847581884914*^9, 
   3.638847694595112*^9, {3.6388477898800793`*^9, 3.638847806743709*^9}, 
   3.638847888222652*^9, {3.6388485203276405`*^9, 3.638848521560043*^9}, 
   3.638850034504409*^9, 3.638850213632795*^9, {3.6388699844391947`*^9, 
   3.638869997636818*^9}, 3.638870630311529*^9, 3.6388708769167624`*^9, {
   3.639234514585757*^9, 3.639234563757043*^9}, {3.639234947194609*^9, 
   3.639234955743424*^9}, {3.63923546768025*^9, 3.639235468023451*^9}, {
   3.6392360164170647`*^9, 3.639236016588665*^9}, 3.639238108190928*^9, 
   3.639238398623765*^9, {3.6392385528340964`*^9, 3.6392385590333076`*^9}, 
   3.6392399812938576`*^9, 3.6392439279164295`*^9, 3.6392439599744864`*^9, {
   3.6392448967901106`*^9, 3.6392449727211046`*^9}, {3.6392450773972883`*^9, 
   3.6392451264593744`*^9}, {3.6392453496645665`*^9, 
   3.6392453693830013`*^9}, {3.6392454954312224`*^9, 3.639245501796034*^9}, {
   3.6392461241918774`*^9, 3.6392461533090687`*^9}, 3.639246578231823*^9, {
   3.6392467757232943`*^9, 3.6392467809995112`*^9}, {3.639247011981043*^9, 
   3.639247019479375*^9}, 3.6392826488507195`*^9, {3.639287540406839*^9, 
   3.639287551202058*^9}, 3.639297488883731*^9, {3.6392978092146935`*^9, 
   3.6392978129899*^9}, {3.6393006519764867`*^9, 3.639300653286889*^9}, 
   3.6393031652374372`*^9, {3.6398434083738875`*^9, 3.6398434087238884`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "915"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1035"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.639843443655938*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1179"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.639843474739983*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EintDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Eint", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6392972694693456`*^9, 3.6392973666575165`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "EintDistr", "]"}]], "Input",
 CellChangeTimes->{{3.6392973697931213`*^9, 3.6392973754559317`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.006944444444444445], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxde3lczNsf9+i6FGGQZL3ZkuWSreKit/VmH0mGLFMqaZ32aZ9qqmmaaiZb
9tAlJKGrbBkKhUhC1E0IIQxC9qfn9fuc53nNt396vV/nnO/nfJbz2c6ZAc6+
dq56PB5vW1se7//+/9+f1kb3Pw+6WJ+D+RxsxMEmHNyXg005eCAHD+ZgMw42
5+DhHDySg0dxsAUHj+HgsRw8joPHc/AEDrbkYCsOtubgiTittrEsDHlMeBJn
/C+sWXzUzrryDeHJ2J7wasPQJU8JT+HMn8rBNhwMXSzlYN40zjgH86Zj1Jnl
dn5RDTQ+HaqRhX2uLnlF4zMQcmKZ34Mdz2l8Bmf9TM73OZg3izPOwbzZnPHZ
2GYa8jRR/xmN/w2R44tFW+eSfKR/45H3ljLx9Xoat8WXuM2Owza/pHFbaMvr
9n4vJn54czjf52DeXM44B/Pmccbn4XxiuxV5+h9pfD5nfD4OZ1oO2Aim3wXI
GWc/JGY38SNdAL0qf7s1sQ9pfCHetDu46dsZshfpQg79RZzvczBPoIvBwVIB
bDtrZw84RfLScMZ5i7H01/uJhrWkbyzmrOdgDQfz7PAgKSZixakXtN6Os94O
ueopy8b1IP1oOOO8JfjVp9MYRRPJC0s46zlYw8E8ew7/9ii/fyCl48bXtN4e
/kfnxtoN+0Tr7dFzRUvvVduZfS2FHW/375PLH9H6pRz6HKzhYJ4Dhz4HSzlY
w8G8ZZz1HCzlYA0H84Sc9RwsFaJff9OFa5/TedAI8co5/zdRCumLtxziuFtL
lvd5QuuX49Yo85ndbzJ/sByxnTz8xEKyT81ydFumqNKXMP+wAgkTu6siy2kc
Kzj0OVjDwTxHCDdc/mn91z1a74h8w61zB8nraL0jdqweWhQ67DKtd4S7+62e
QxeV0fqVEC333nv/UymtX4k3+9wuJw+7Q+tXInSi8cjrH0jfmpXwy544dNpc
skfeKpzOXGDb1Zz8G1Zx9s/BmlX4Wje029+/mP2sRt5Nvc2dgm/R+tVwGRTt
4Hi5mNavhm3is1rn4xdp/Wp8z1TlP/9K/PLWoC6gYLttm2ZavwZjJ1xSt8xj
/nYNUvv6X++qIXlo1qDdoqd6ia9rab0I6x57f/FYR/7RVIQ2xsWSQ0mkP4h0
9y8SoepDlkVcGyYfEbIqO85omfDf/3CmCIXaNmNujiN5akTAKVX5jn/O/w/X
i6Ap6THhdkUF0XeC7F5jrusi2q+pEyri7vB//XuS6DvBQf9Z314d6XyLnGDX
Wbj0ZyHz104QTYpcuPfPg0TfCab5ywoUFtVE3wnitHbDF5WQvuudIPijbvuZ
22SvPGds6Zi9vN0E4s/UWZdftOIyB7udq68TfWcY5Vxx3lFD/EqdMTJ2hrBp
/RWi7wz3DO3aLbnniL4zpJ7pLn8MInnUOyPUPcTxuzn5C95alFdGT/ml/ED0
18J898ez2ck3iP5a5I2qdhtcdpvor0VGxwsLi/PJXqSteMb5dbkH6HuZa3Fx
Zr/Tda8bif5afN8cNuK4NfFbv1aXP54Lqs6vbLS/SfyZusBhf+9T7cNriL4L
bFVjb95T3ST6LuB1mv44uVMJ0XdBw5PGp75vaT+ZrePuydNm3i8g+i7oJOxr
nHqX/EW9C0Qq67FH25A8eK6oq+nRsFJG/sDUFYZZ07v+cCP7hyvWHluVNX7b
Z6LvitS5qQdEs5n+XbEg7KD2nh/JL9MVPtc0T919WLxwRUNHfqfJ3QjXu0L4
b4mL4hOdB54bvteY6Y0zekD03fBp1Jhff6Qzf+SGvsu85vWwYPbvhoaTm4Kz
Or0l+m7INJh2ZouG+Ml0g4G298wwA9KHxg2Dl0r+SnvN+HdDt5gIoxubmP9Y
p6sP03Vo6mtzeEYl8wfr0Lhv12sDK4q/onUQeu/YsuEC2Ye0df2uY0OvzCwi
+uugNRt2s1yVR/TXwfRIV5v788qJ/jpYXRo4OLCK5YvukKmu6e1tpP2YusPg
QtnY51KyH7jDYpa7ifw9zRe5o+OF3pKsk01E3x3/7mm6zxtG8zPd4Tzc4WhF
NMsX3HXjc707fP0/Dxtznebz1nP4X4+9zw78abbmLtFfj65tt+QcTyN9iNZD
ueXBWdF8+p50PcwN/lti403nI3M9KlI/Xh9+m8Xr9eix+vAmO1PaT/16wDfD
a8Vq5v890NvV/IenktabeqD2lqd09HTyj/BA4YB/pww6QPYu8sDfx0qX/raS
5VseyBlm13jmOdlTpgfaOEeeXtWdxTsPfO1gPkhgQP6o3kOXX54nh39PxETW
5/RqIHnDE27iuXdLZpE9iTjzpZ4Idky20fMk/5nJGdd44mt4w9GmS+TP6znj
PC88GH077roB7dfUS3ccHCzygsOQTo69trJ8lDOeycEaDq7nYJ438kzNf0yK
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
XD5dsGsTuz/gJ2Gk60uzF74kPxPOfNMk3f2bJ2HN3BRl4BvyPxac+dYcDA62
5WBBEubueFP9+SDZhzAJYQ9uje7gwN4DJWFGql6GcC47/0lI7/XO7yA7T+Ik
lL15P7WlkJ3/JCTNPHDqkQF7H5uE1c4zMn68Y/VfEn702ZV08Q3Zm4qzn4wk
WHU8Ozy3gr23SkIpDDZ2asv0n4ST+0JkuacpPuQloXaiwyK+iuy9MAnFH3l7
g7NY/t9Kv/2Roh1NVK+UJuFDbJ7hpYMs/iehvoNDzuMd1J+pTgLufLM3Ks4l
/Sdh1qUtp7oa0v4ak6Dt+WPIkAbSl7ZVHtKtvnI9kldLEvKfjbbZaMLeDytQ
EvnNM+Ek0dNXoPBAxONdO9h7IAVs/yzzOJhB8dlEgcndXspNj1D/zFQB9yuX
Fo3rQP0wcwU6mE+I0+vG+uUKbDyxpKZNFMU7awXQzubeul50XwIFaivUzrfd
6T2XrQI2loa2Bhl0HgUKLIkwr7fpTfIWKuDcpfuVWUHkv0QKaG4UD+qwidV/
Cmzfe/thuT7Zn1iBN2bX3N06s/pfganOr2vfVLLfgyiw9fVeD3t3+p5cgahf
8aMy3pH8VAqs3VxwsT6M6GcooHBtH3X8C3tvpkCFZWLqBxfiJ1uhm5/ltfJT
7nA8aBur/xTY5rr5Y7ce7PwrsGJqwuvaWhb/FZgygX/MLYn5fwUi9p+c1nMy
8VetwP/0xs6/AjsaT5ovzmX5nwLGP4zHX2X9YK0C97zNzAYvo/EWBQ6Pbszq
+Y29/0jGrOOna9N3U3zRT8bJY/9tPsDyPX4y3g/nhd75wur/ZKy2Ls8uXE75
tGkyVAsezN4Qyuq/ZNxwWx935DHFb4tkGPULnbG/D2HrZN39g4Ntk2FmmGk7
8LevpP9kdNEG767Np/0IOfNFydA2J0paBrL8Pxl659RXIrzI3sTJkJoZ++kp
6LxJktFRuOvLLn/W/0lGm8EBpgf7kT7kydCsv6WSzaf8RZUM0SHh2ENb6Txk
JCP20Ln0Pc/Y+5xkSIY9GlI4nuZnJyOjRmjv8DeN5yXr5luFyWhc0cfz/ECq
xzTJ4G+vMtm3jeiXJqOyxv/r32PZezYOv9XJyBp/qdvVqaz+T8Y5P9seRnKW
/yUj8MX3JzkfqB+kTcb8bgMm7qlk+V8y2k6onNGYxO4/lCgPTDt7jb3v0lfi
p59r3p917D5QCX2PjHFPSsj/mChR+uLL+hPzqN40VaK6f/sFJ+xY/afE98V7
tvUewPy/EilxOLj9Or3HtVZy9K/ECCuX+HmXyP/acsYFSlgrrw/JXUjyESrR
/6vm8uPv7H2REmZHp74VS4i+uxJK2xSDTstpXKxExWSn6IZKGpco8aZy/IDy
nez9lRKRH/6a11zKzr8SNf7zb37fQP5QpUTRGMfaEQEs/1PitGPSvr3svjZT
CaHD0auKl8dJ/63zt3T5ULaAxX8lym4e+uemmvRTqIRmykgvYR79HkKjRKGJ
NX6UkjxLlcj/7/yaniWUv1Qo0SWr7uFBJ3b+OfKp5+BGDtZycAsH81J0sT4H
81NQkyrd/Pw3dv4546YcbM7BFhxszcFIwfSTYU1LE8gebVOgPXVrVhmrlwQp
mDzx/VlPc8JCznpRCjzfXeivz/ydeyt2XBp02ZTpPwWm1y/z9m1h8T8Fa65d
HxU7heKBNAV17ZyqXi4kfctTIPf+pym4mPajSkHJyXZvrHLJv2ekYGyo51NV
Nev/pKCNweNr28aTf8lOwZ0DdRcLdjD/z9l/YQqUXc5eKbvAfp+Rgr7LvJUz
1ZSfl6bA9hv/9+EPyV4qUrDyc1K6ZRHdH1WnQHVn3Y23fSn+1qdg9Qivq/w5
TP8pEOwdl5zvT/5Gm4L/vPoHplrSeWxplcc/8g6XBez8p+KEX5H+ZmNW/6Vi
wrkApxJ2H8lPxevps62P1zP9p2Kyvc2gfv/vfWQq8pP6jxpfSNg8FUayLT4P
vcieLVJRctX9yo7fyZ6tU9GletmyRTfZ+/ZULLxU41wcRPKyTdXVryAV+tVR
VxveMv2nwiHpkHjJcooPolS4pi2Mt2TvQd1T8dTk+azrF9l7i1QYTAqVdZhJ
WJKK+UNtNV4z2O9HUpE77LCxVz6r/1Ixc9+Jv9u3YfexqYgq5QWu8Sb5ZaRi
xsDi5EObWf8nFXv/cy5cxn7vlp2KAVdfFBdtYu81UzFpTbv+t+4QvcJU/BiY
fa/zb8SPhsNvaSqmG6/uI4kiehWp2BOwca3Jdub/U3Fl8Lr44yvZ+8ZUSOo8
bpkZkf4aU+Fx2HfLQhnZq7YVdwrJenma4lNLKn4+dnDJbMfeP6ShympIstkA
dv+Thv13dy91fcb6f2nI3NbxuHtXkp9JGo6PqHqz1pO9D2wdP7t66xIR8/9p
+LLokr/VHXb+07D365dpBs5k39ZpWNrNMsZEyM5/GqK+Pyg5O5XF/zSO/tNw
sNo7960N7UeYhicjnikF7ux9SRosnv9c0CeN1X9p6BXQFFdY1EL6T0N1rFVX
y9e0X0ka2gUqp/Rm95/SNMRuvpfbLpjOrzwNqxyuzjX4yc5/GizvK4umBdP3
MtJgfcpr5NwdLP9Lw/SBP2Yo2Hu57DRozBR/BEWx9+ppaGmTc/GlK/UHClvX
p/DdG83Z+700nDUe/cvYmPKL0jTYuq4cPvgy+ZeKNLyQL4g06sjuf1v5fZLi
t7wfxa/6NIwY1b40bAqd90aO/LRpODp/zcOkByz/T0PuIM8N+QKW/6kQldW7
aE8nwm1V0JwrHGU5iexHX4Uqs+HiRyyeGarQ/L6HqPQy8ctXIbPt1MOmW+k9
p5EKlv41B2r4pC8TFRxrPmfntCPcV4W7fc7HR3ix97Wt87edLfxmQvwMVqFa
fkSgncnqSRX+7ub1zyuWP4xUwX7DLPmlmbQ/CxVGiRPU/Vl/ZLwKVjMv5IeM
J3u0VqGhtiK9zoHGJ6t05QMVYj28i1ay37PMVOHDyrTH/72neGCrwvhFvu9O
/0Xj81Xw+Zhk3e0B8SNQweJo3wlNwbRfexUC638pbaREX6jCsx2Tjx+6QPpe
qcLL0TtLO2xk74NUKEi4FyHe+ON/2KVVPlcnVm9Uk724qzDBNed4dwH5Ey8V
knLqVhiYsf62ClsP/TH6sxXxE6iCaGPEisH32XsHFeCj9PG49+//cIQKtn+U
HjZac4HsXwX9Mqm1E8vfZSrdfESuQot82qHcQuqnKlXYvm1tsU172r+KI8+N
KtxZ6yQ+yfK/DM74Dg7O5OAsDs7m4BwOzuPgfBUiBEN56xez+1bO+FkVjLTD
9rm5s/ejnPGSVn2cS7dwyiP+Sjnj1zm4goOrOLiag2tVmCs7tDtrHOmzXqWb
DzSosHtk4AEvB7K3xlb9D1iyfOhlOr9NKlw0989PZvWCVoWEWTt+Zn0hfps5
9Fo4+DsH89S6uK0aZ7o33jhyjr0HUkPy+PJZx8fs/HPm89XY6LZzvSt7b2yk
xhRzddhPJxYv1PA1DN9vxt4z9eWsN+XgwWrd+G2uxrDcZQ65v5E9jVTDrqLh
m6YLe4+vhn7uj3t2KjqP49Ww8XocMK0t6zer8aHRapQh+33xZDXOuu950nst
+/0Kh/5MDrbl4Pmt66+XJnd/yX7voAYfu3+2/Uj6sm/df1Ho6guTWL9CjTnm
xTIJex+yUo2xeie8K0DjIs73XTjYnYO91OhmfDbmpZL4E6t141WgWjc+SdQY
KFl59FEV8RuhxtEexmM69GD9LzXq0gcLPb+RvmVqKM5eUxzOYO9h1DgXurL0
SznJX8nZj0qNWc9fVi1yov79RjUOj+q+MWUO65dw5u/g4Ew1NqdZTbtzkOZn
ccazOThHjejyzh1CtrD3oGqUGb97yH9D+89Xo8qm/3++U+h7hWosDVll5cHe
75xVo4f4y7dOLJ/QqFGff2vZmNk0v4RDr5SDr3NwBQdXqVGyckH5xMfsvYYa
NcMUt8ey9/K1auzu+WvrUWf2PlkNNx/NWXP2+4EGNZb82dJfw+TfyPl+kxqO
Aw6fCx9D/Ultq/3vzRp3yI3iZzNnfkvr+d18//z2TySv75xxXroubsvB+hxs
yMF8DjbiYJN0tFm8YUTPCZSv902Hwe9tvrlsYe8H0mG4NnrSpSLCg9PBn/Gi
4OIqFv/TUZE//NPdAnq/MTIdXSRdq/Nc2f0Ch974dMTG9+jYgfXLrNMx7MGP
lZ6vyT9N5swHB8/kYFsOns/BgnRkpAzuHTmV7MueMy7k4JUcLEpH+6i8w5PH
0noXzrj7/8f/ByOImsk=
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 1178.}, {0, 1.848740089095754}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.639297375986333*^9, 3.6392976201735616`*^9, 
  3.6392978935328417`*^9, 3.6393007244074135`*^9, 3.6393032026619034`*^9, 
  3.6395722157879157`*^9, 3.639627466358008*^9, 3.6396311061315217`*^9, 
  3.6398432434226418`*^9, 3.639843369305832*^9, 3.6398434798209906`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdataDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Edata", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639297389714357*^9, 3.6392973985283723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", "EdataDistr", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.639297406874387*^9, 3.639297423394816*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw91nlYzO3/NvAiRCEiIYQQQihayCkhSkp7Wdq1qKZ9r2mf9pkWIlGErJXt
TrRYIoQs0aIUUVkSoqL49Rzf6/34x/G6r7k6P+ecM7dm27jvsB8mJCR0SERI
6P/9/b8/3eseq0uUKE9/uo79Bwh/EzKLvEYWRYClfHDglhfMEvhtN7sr5TF5
ElwqJon+fl7LLA3NnLp4sR0vmWVgVpC1ep4DWRZ/ntVO8eGQ5+C7/tjZl9LI
cihKvfUv7St5PnJ9cyJbV75iloen0Pjcar065kXou9GR/tyNrIALf3/L7Y8m
L4WTnpatD5+sCEX7S99e3yUvh45uyMpX+vXMKxCu83FdbRB5JS5NSDFe009W
Ql/1z9p2kQZmZeTvXSqotiGvQriqvvFnV/JqLJ5VPE4tk6yCr83iqvrlZFUE
3itZoHGTrIaHKZ/CjN+Q1TFp6vz2gJ/kNfCYssT0u3gj81pwMzW3tkqSNdBm
F9P9rou8Dg8v7w3unP2aGega6zL72HJmLtAmlrE83pLO10NdyHCFXiydr4fT
iyfKBQfoXBP78pL/GGXRuSaurAhounGXzjfghEGMHOclnW+AxnST0R8XNbFz
Legb7tjqqMfM1cL0sdZebvZ0vhGOLiNviHrT+Uasq7+uvyKczjcheNGvsOiz
dL4Jhz/2GV45T+eb4R4wbOybVjrfjDX2e0Wb2uhcG0oQ2ZvSRefacBWv2F0m
0szOt0Az2/diogQzdwukUsKixOfT+VYo5PR3uNrR+VaYSLvf4ifRuQ6WNr5U
3Z5P5zqYJ+Jfl9JD57oIvThYXz3zDTvXhbrXiG+jVZmFtkFO+2nA6J10vg2/
uMMD1ZLoXA9VH4ql7Y/SuR44o5YZF7yj8+346FWx6tPSFna+HZpWs9+uWMUs
pI+b74xKr6gzQx99aj7cG+vo9fpQdDiw0T6cuUIfrUviIyIv0X0D1BvaPQi4
R/cNcMez3U3vGd03wI897w8HNdJ9A+hlqaYnNtP9Hdi0zroicZDu74DkxJ2+
Pv/o/g701kcd3DO9ld3fgYaa5ssf5jMLGUJ6bcTlXFVmGKJJcu6pn2rMXENc
LZdWz9tO9w2xZVrPDkdLum8E85bGcWfs6b4RrgdPunJtL903glzzcoMTHnTf
CBfcFDf7FNB9Yzy6mOM7UET3jdGsfGKL3SW6b4yB8LiUkmK6b4z6z6Lz/1yn
+yZYpb0sPfU+3TfBWOuUxbdr6L4JXuaeDT/dQ/dN4Jt9pCDpD903hdr5sMVL
hN6y+6ZwnSqst0SMmWuKSynFja4TmCtM8fpfyJrCWcxCZrAd3iDRNIfum2G4
8BRdzkq6b4Zpv0cLHNXpvhl+qp1/8WMH3TeHdFdlQ6UR3TdH2Y2/ryea031z
/L7Rk/Pdmu6b42t9cYaKD923wNv61cGtoXTfApOyWurSw+i+BWpdqqbOD6f7
FlidUnnWPI7uWyLDeKX9zkS6b4nzV4WF+tPpviUu/Bg88ewo3bfEvWk9L5cf
p/s7YSulfNjwFN3fiVqPaxm3z9D9nTDUerT73Xm6vxOyKq/Lmy7Q/V1YEb1u
2OkrdH8XDCYYbHrxlO7vQvgUweuWZ3R/F1zmzF6n0Ub3d8MiTbnRtpPu78ZA
0/2MFVPfsfu7MWtAT/aCHHPFbmS/1K5yXMQstAfOxovHflZnxh4cu/Xu+dH1
dH8P0oRjpT9upvt7MLZb11JMn+5bQfSz0PcppsyyVii4u2LiYzKs8EFq7n9F
e5itrPDN+FzIayv6+VZYXDJaKNiBOccKMZfbbeNDKM8K173nuzhGM7dYYcB1
1sktSZRvDZNtJabDj1G+Nf56WouK3qF8a8iUTr9lXk351uiPMTLNe0b51niW
JK97q5XyrREy/XxFfQ/lW8P7vr9aTj/lW2NN2oXRfkJtLN8Gs8c4WV2Yyyxr
A/n054f3z2OGDbKPhKYpyzNb2WDXBefqMjLXBrKiWlPPKzDn2CB1XFdY5XLm
ChvUbhc++FGJucUGHz1PSB9So3xb1CXaFkxUp3xbFD1SC9hMhi1OT7z38KUu
5dvC7sHBIKWdlG8LY8PizlW7KN8WVyeoHom3o3xbVC11XmXjQPm26N0t+U/P
ifLtoJi1e0OFC+XbYd4bw5ub3SjfDqafzm0qdqd8O1xbcHJ/OYfy7RAj3HZH
PpTy7aBSe2NNdQLl2yHXRdmtK4fy7WCQbAmps5Rvj/sDpSJfLlG+PWRjP10O
LqF8e/TcOaW+/gbl2yO6f/PwCeWUbw+7mnnbHlVRvj2m/vjQcbma8u2RlhHV
OvYx5dtjqbZfsshTyndAwOpmPdGXlO+At/vfnwyoo3wHvDw7sbbqNeU7QOxE
9wbPJsp3gOwvnfMl5BwHNLzwUX9Frhhy7vXE6e2U74DNmdMcEz5T/l68OMKP
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
Eof6h0AzUOKElyf1D0FK9e7/On2pfwhcjvckDZCFQnHT7Fd8XSD1D0Wr3eX9
4SHUPxRjPITcS7jUPxQlNfvdg8OpfygE+RyLdrJ+KDIHIzR0Iql/KBYP/XOl
yqP+oTg9jmO3Ion6h0L692mLtWR+KM5LNidtSaP+oSidD4M/h6h/KDbEBDRU
5lL/UAwUP9m34hj1D8WDAfEFzsepfyi6TqRG+5O7Q2E0vGTyqLPUPwzCxjJt
U85T/zDsmdvmWEeWDUOWy4N2fhH1D8Ohjrcl3SXUPwwbC0qqf1+n/mEYeVKv
TOsG9Q/DtsiJJ2RKqX8Y5Ew1xkwuo/5h2NBck1RSTv3DkDateZrTTeofhuvB
BSfX3aL+YfhVOj76xG3qH4Zboj4nj9+h/mGwqnx/5N0j6h+GmXXbbz57TP3D
kHmsPNathvpzsUx/8Z7FtcyiXNi8ujwuvoHeDy56Fp7dm0eW5mJhi5jpRbIs
F5nhGyuSG5nlufi3OGCKRhO9X0NuHzZxbDOzChel2/J2XSSDi/K66nyZNmZt
LpTnypmf6KT3k4u1KlW/dn1iNuMi96SlwsjP9P5y0T6z48XUr8yOXHjGaMdn
kDlcmKgvDSwj+3MxWvLRnPvf6P3n4kNp+Nt9Pcw8LrZbSC169Yv24MLgYUd7
Wi9zJhc6i+IrbvTTPlzs/X5vy/Z/zPlczHDzXHF3eCfbi4vY55dO7RJlLuYi
xcDx/KHRzBVc2HKzpl4dy1zFxcNVAfumT2Cu4eLBidRaz8nMdVxUdV3IzyC3
cNE6SjqlT4q5g4s9Ax2FmVOZu7noN1pUt3Aacx8Xw6d7Fs+YziwUjvqOiTV8
GWbRcES8U2+UnMksEY5ppxVdM8nS4Tj88GHXU7JsOJ6KLopMmc0sH46VXZm/
N85hVgxH1V/uF305ZpVwOFXumbFBnhnhGPPze/hMBWbtcLRNjprkt4xZPxyX
DOZe46gzm4Xj7ZWDPyvXMFuFo7D/U6q5BrNjOIxPrZco12TmDD1/5/WelxuY
/cPRCKfOg5uYueG46PbWrZ3MC0d6w7YA7mZmfjjChc8+P6DNnBkOQXpR29Kt
zDnh2DxvUe4oHeb8cATXL/v2/10Yjtw39XZjyMXhKLVYcHciuSIccWpZX+aR
q8Ix67n622xd2j8cf6/t2POEXBeO1Z/7eL+30f5Dr9eat1Vcj/YPx2DOmPgG
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
ztwdj7WFrQUlK5j74lG34/3gt5XMQgmQqpPPN1djFk3AeBnNJ6fIEgn4uGvT
uHqydAL0MlY6rzRglk1AyC3JwmNk+QSUFdW8vmzGrDjko7t+8PYwqyQg1dF+
mYwNMxKgzNMvS7Nl1k5Anld9c70ds34CfhrsmOdjz2yWgFfqbbyrDsxWCfCz
L3+g48LsOPT67UGR99yYOUMebymi4M7sn4CCxJPtHzyYuQkQOby0OC+UmZcA
n9uPN/rEMvMT8ELwpX9fDnPm0POfGe6bT85JwGnTL6cGjzPnJ0D6wdc3kqeZ
CxNw+/7JcE1ycQJUwlNHF52h/RMwwu5vUd052j8B26suaPZepv0TsPv5m0+O
V2n/BIyML7NsqKD9E7DtlExC/E3aPwG6llmdix7R/gnwGpVsUvCY9k+A0QG1
j+pNtH8ipifnbZr5jvZPhJfextsqXbR/Ig67Xyv+8If2T8T1OAXN5gHaPxEP
haT93vyl/ROx0W7NU70RXWz/ROjkO/C/jWFWScQfi/PvXo9nRiIkfsuMUpzB
rJ2Iu9oyAWfnMOsn4sm3t2Wai5nNEvF9z2iOwmpmq0TEWLY5H97C7JiIat3i
IrutzJyhPsonueXbmP0T0fNKPUF4BzM3EapLJNf+MWPmJcKqR/7C8t3M/EQo
jbcMlrJizkzES7OvR4PIOYlYO+/URVdP5vxEeKa1H20IZC5MxOPZhWdSQpiL
EyE2Z+tFkSjmikRk98zevTSWuSoRc+t7xXQSmGsS4W20VKU5ibkuEZ3nOstX
8JlbEmGf1N/ouJ+5IxH5ozSVJbKYuxPBSx598+R55r6h5y9uDD1dyCyUhCPj
Sw6+IYsmIeXjovavV5klkjBjqenLa3eYpZMwIG8kKl3JLJuEnrqJw4f9ZJZP
wlsn4adzemn/JFy/Uaj7bZD2T8LUzC/HaoS/sv2TwJ+g/M5EjFk7CWHLO9/9
IesnwTFh2pMN4sxmSXjlP3l++HhmqyRszwxws5BgdkxCQtChOXZzmTlJMJs+
uLCV7D/Uz+/jHCN5Zm4SQj7yZx5XYOYlQVFl4NwhZWZ+ElZDcneqGnNmErov
V+0KB3NOErZ5hlzdupk5PwnJbztcD21lLkyCTdegzmJd5uIk7H6SH3dkG3NF
EvYu86tbtJ25KgmbD/8tuG3IXJOEQhUdw7W2zHVJyH5zZWK1HXNLEpYUWn//
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
iTtHfs9kdkyFz9VV/5ri/6z7PwtztUU=
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 1178.}, {0, 1.7214031190191268`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6392974079663887`*^9, 3.639297423878417*^9}, 
   3.6392976283479757`*^9, 3.6392978978384495`*^9, 3.6393007251406155`*^9, 
   3.63930320653071*^9, 3.639572216349517*^9, 3.639627466919609*^9, 
   3.639631119937546*^9, {3.6398432442926426`*^9, 3.6398432537446566`*^9}, 
   3.639843377205843*^9, 3.6398434842809963`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Energy", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6392977934430656`*^9, 3.6392977988406754`*^9}, {
  3.6392979060284634`*^9, 3.639297910162471*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 1253.6526996704547`}, {2., 1046.1032936368372`}, {3., 
      1054.2082596760647`}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 1035.7258233351565`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 3.}, {1046.1032936368372`, 1253.6526996704547`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6392977991526756`*^9, {3.6392979005372543`*^9, 3.6392979105524716`*^9}, 
   3.639300725171815*^9, 3.6393032089019136`*^9, 3.639572216380717*^9, 
   3.639627466950809*^9, 3.639631133322369*^9, {3.639843244312643*^9, 
   3.6398432547946587`*^9}, 3.6398433866738567`*^9, 3.6398434871610003`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1261, 1382},
WindowMargins->{{Automatic, 504}, {Automatic, 8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2385, 59, 112, "Input"],
Cell[2968, 83, 620, 10, 31, "Output"]
}, Open  ]],
Cell[3603, 96, 4884, 116, 132, "Input"],
Cell[CellGroupData[{
Cell[8512, 216, 106, 1, 43, "Subsection"],
Cell[8621, 219, 10844, 244, 772, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19502, 468, 112, 1, 43, "Subsection"],
Cell[19617, 471, 4794, 105, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24448, 581, 102, 1, 43, "Subsection"],
Cell[24553, 584, 2778, 69, 432, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27368, 658, 108, 1, 43, "Subsection"],
Cell[27479, 661, 12847, 298, 1106, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40363, 964, 105, 1, 43, "Subsection"],
Cell[40471, 967, 14748, 292, 1152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55256, 1264, 106, 1, 43, "Subsection"],
Cell[55365, 1267, 12233, 235, 1372, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67635, 1507, 98, 1, 43, "Subsection"],
Cell[67736, 1510, 6625, 116, 392, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74398, 1631, 99, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[74522, 1636, 8564, 177, 532, "Input"],
Cell[CellGroupData[{
Cell[83111, 1817, 261, 5, 23, "Print"],
Cell[83375, 1824, 260, 5, 23, "Print"],
Cell[83638, 1831, 260, 5, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[83925, 1840, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[85279, 1881, 139, 2, 31, "Input"],
Cell[85421, 1885, 15232, 260, 236, "Output"]
}, Open  ]],
Cell[100668, 2148, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[102022, 2189, 167, 3, 31, "Input"],
Cell[102192, 2194, 16274, 277, 236, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118503, 2476, 250, 5, 31, "Input"],
Cell[118756, 2483, 1253, 30, 240, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
