(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102366,       2203]
NotebookOptionsPosition[    100539,       2137]
NotebookOutlinePosition[    100886,       2152]
CellTagsIndexPosition[    100843,       2149]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorData", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
    "Import", "[", 
     "\"\<C:\\\\ETH\\\\Neuro\\\\GlobalTracking\\\\GlobalTrackingScripts\\\\\
tensor_data.txt\>\"", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"dim", "=", 
  RowBox[{"Dimensions", "[", "TensorData", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Tensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "6"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6376408711401596`*^9, 3.63764090944243*^9}, {
  3.637642223442727*^9, 3.637642224035528*^9}, {3.637642588013631*^9, 
  3.6376425897452335`*^9}, {3.6376427209040656`*^9, 3.6376427701155524`*^9}, {
  3.6376428653375206`*^9, 3.637642901132984*^9}, {3.6376430845609083`*^9, 
  3.6376431307283897`*^9}, {3.6376431863066874`*^9, 3.6376431866342883`*^9}, {
  3.6376436659501348`*^9, 3.637643671285344*^9}, {3.638016044529835*^9, 
  3.6380160579776044`*^9}, {3.638022352874652*^9, 3.638022357140896*^9}, {
  3.638026101989089*^9, 3.6380261058433094`*^9}, {3.6380295187905188`*^9, 
  3.638029591439674*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9", ",", "9", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6386947448877144`*^9, 3.6387265492276173`*^9, 
  3.6387691619472556`*^9, 3.638778407116049*^9, 3.6387840076943836`*^9, 
  3.638846436643702*^9, 3.6388481010602264`*^9, 3.638848734984867*^9, 
  3.638869857688972*^9, 3.6388705145905256`*^9, 3.638870866995145*^9, 
  3.639234454604957*^9, 3.6392440159317846`*^9, 3.6392826506447225`*^9, 
  3.6392857231432467`*^9, 3.639292521978692*^9, 3.639300656656495*^9, 
  3.639303123335764*^9, 3.6395721901988707`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", "vec_", "]"}], ":=", 
   RowBox[{"{", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "   ", 
     ",", "   ", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "   ", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SurfacePositions", " ", "=", " ", 
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.639300281210635*^9, 
   3.6393003142982936`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.6392936406098566`*^9, 3.6392936450558643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"E0init_", ",", "\[Alpha]maxinit_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]max", " ", "=", " ", "\[Alpha]maxinit"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"E0", " ", "=", "E0init"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Surface", " ", "=", " ", 
     RowBox[{"Select", "[", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
        "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"S", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"S", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "Pi"}]}], "}"}], "]"}], ",", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "*)"}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<tensor\>\"", "->", 
               RowBox[{"Tensor", "[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<direction\>\"", "->", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
               RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "1"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kk", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<forward\>\"", "->", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<backward\>\"", "->", 
               RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"A", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<tensor\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<direction\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<forward\>\"", "->", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<backward\>\"", "->", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.6393002972786636`*^9, 
   3.6393002976218643`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neighborhood Functions", "Subsection",
 CellChangeTimes->{{3.6392936149010115`*^9, 3.639293620953822*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        ">", "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", "spin_", "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}], 
         ")"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], "<=",
        "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Functions", "Subsection",
 CellChangeTimes->{{3.6392936023897896`*^9, 3.6392936060245957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"backward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"backward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "backward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "backward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"forward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "forward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "forward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], " ", "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], " ", "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"Surface", ",", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["E0", "2."], " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"Log", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
               ",", 
               FractionBox[
                RowBox[{"cos\[Alpha]", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                RowBox[{"1", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"E0", " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"Log", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
               ",", 
               FractionBox[
                RowBox[{"cos\[Alpha]", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                RowBox[{"1", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Edata", "[", "spin_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], ".", 
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<tensor\>\"", "]"}], "]"}], 
   ".", 
   RowBox[{
    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.63929410027643*^9, 3.639294147497713*^9}, {3.6392945813968754`*^9, 
   3.6392946417221813`*^9}, {3.639296628969*^9, 3.639296632198206*^9}, {
   3.6393001043219247`*^9, 3.639300134679578*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create New Spin", "Subsection",
 CellChangeTimes->{{3.639293662886696*^9, 3.6392936685651054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateNew", "[", 
   RowBox[{"str_", ",", "spin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newposition", ",", "newforward", ",", "newbackward", ",", "newID"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"str", " ", "\[Equal]", " ", "\"\<forward\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "+", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "->", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", "spin"}]}], "}"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"newforward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
           " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newforward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newforward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newforward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
         "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "\[Rule]", "spin"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", 
                 RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"newbackward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
           " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newbackward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newbackward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newbackward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392954013625145`*^9, 3.639295402984917*^9}, {
   3.6393002043337*^9, 3.639300208124507*^9}, {3.6393002499637804`*^9, 
   3.639300267217411*^9}, {3.6393003300543213`*^9, 3.639300367509987*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Associate Spin", "Subsection",
 CellChangeTimes->{{3.6392936975499563`*^9, 3.6392937056307707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Associate", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newforward", ",", "newbackward", ",", "oldforward", ",", "oldbackward", 
      ",", "E0", ",", "E1", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newforward", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"F", "[", "spin", "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"What", " ", "if", " ", "newforward"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "}"}], "?", " ", "Should"}], " ", "not", " ", "happen", 
        " ", "for", " ", "volume", " ", "spins"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"oldforward", " ", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oldbackward", "=", 
      RowBox[{
       RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ", 
      "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ">", " ", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", "oldforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "oldbackward"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "==="}], "="}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"newbackward", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"B", "[", "spin", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"oldforward", " ", "=", 
      RowBox[{
       RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oldbackward", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], " ", 
      "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "]"}], ">", " ", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", "oldbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "oldforward"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.639295315733964*^9, 3.639295323128377*^9}, {
   3.6392953553112335`*^9, 3.6392953706460605`*^9}, {3.6392964505982866`*^9, 
   3.639296515712801*^9}, {3.6392965903433323`*^9, 3.639296615053776*^9}, 
   3.6395856182681203`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Align Spin", "Subsection",
 CellChangeTimes->{{3.639293712900384*^9, 3.639293715380788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Align", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newdirection", ",", "olddirection", ",", "E0", ",", "E1", ",", "p"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"olddirection", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newdirection", " ", "=", "  ", 
      RowBox[{"olddirection", " ", "+", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "3"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newdirection", "=", 
      RowBox[{"newdirection", "/", 
       RowBox[{"Norm", "[", "newdirection", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], "=", 
      "newdirection"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ">", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         "=", "olddirection"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392953793196754`*^9, 3.639295386402088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 CellChangeTimes->{{3.6392937224788003`*^9, 3.6392937236644025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Energy", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{
    RowBox[{"10", "^", "3."}], ",", 
    RowBox[{"Pi", "/", "3."}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "n", ",", "s", ",", 
     RowBox[{"N", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "\[LessEqual]", "N"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Energy", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"Energy", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Eint", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}], "+", 
             RowBox[{"Edata", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "2"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "2"}], ",", 
              RowBox[{"k", "<", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Associate", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "<=", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Align", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "}"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6387265850926685`*^9, 3.6387266182545652`*^9}, {
   3.6387266547656536`*^9, 3.638726730015958*^9}, {3.638726767279089*^9, 
   3.6387268341269126`*^9}, {3.638728996310582*^9, 3.638728998703719*^9}, {
   3.638774777993475*^9, 3.638774796595539*^9}, 3.6387758845047636`*^9, {
   3.6387765618485055`*^9, 3.6387765648386765`*^9}, {3.6387766067520742`*^9, 
   3.6387766089281983`*^9}, {3.6387767545385265`*^9, 3.638776780083988*^9}, {
   3.638776871456214*^9, 3.6387768987137733`*^9}, {3.6387769612843523`*^9, 
   3.6387769751051426`*^9}, {3.6387770351615777`*^9, 
   3.6387770446761217`*^9}, {3.638780724314585*^9, 3.6387808244323115`*^9}, {
   3.6387808660246906`*^9, 3.6387808743601675`*^9}, {3.6387811093806095`*^9, 
   3.6387811422604904`*^9}, {3.6387813280711184`*^9, 
   3.6387814042754765`*^9}, {3.638781445752849*^9, 3.638781497681819*^9}, {
   3.638781740086684*^9, 3.6387818031062884`*^9}, {3.6387818667979317`*^9, 
   3.638781870587148*^9}, 3.6387820216447883`*^9, {3.638782085824459*^9, 
   3.638782089326659*^9}, {3.6387831847253127`*^9, 3.6387832302659173`*^9}, {
   3.638783265513933*^9, 3.6387833131676593`*^9}, 3.638783569945346*^9, {
   3.6387836932844005`*^9, 3.638783694868491*^9}, {3.6387861824447727`*^9, 
   3.6387861925063477`*^9}, {3.6387867726195283`*^9, 3.638786775172674*^9}, {
   3.6388464914933987`*^9, 3.6388465005414143`*^9}, {3.638846557481514*^9, 
   3.638846576731948*^9}, 3.6388468052063503`*^9, 3.638846942658191*^9, {
   3.6388470085215073`*^9, 3.638847011345112*^9}, {3.6388471927422304`*^9, 
   3.638847229917096*^9}, 3.638847460469901*^9, 3.638847581884914*^9, 
   3.638847694595112*^9, {3.6388477898800793`*^9, 3.638847806743709*^9}, 
   3.638847888222652*^9, {3.6388485203276405`*^9, 3.638848521560043*^9}, 
   3.638850034504409*^9, 3.638850213632795*^9, {3.6388699844391947`*^9, 
   3.638869997636818*^9}, 3.638870630311529*^9, 3.6388708769167624`*^9, {
   3.639234514585757*^9, 3.639234563757043*^9}, {3.639234947194609*^9, 
   3.639234955743424*^9}, {3.63923546768025*^9, 3.639235468023451*^9}, {
   3.6392360164170647`*^9, 3.639236016588665*^9}, 3.639238108190928*^9, 
   3.639238398623765*^9, {3.6392385528340964`*^9, 3.6392385590333076`*^9}, 
   3.6392399812938576`*^9, 3.6392439279164295`*^9, 3.6392439599744864`*^9, {
   3.6392448967901106`*^9, 3.6392449727211046`*^9}, {3.6392450773972883`*^9, 
   3.6392451264593744`*^9}, {3.6392453496645665`*^9, 
   3.6392453693830013`*^9}, {3.6392454954312224`*^9, 3.639245501796034*^9}, {
   3.6392461241918774`*^9, 3.6392461533090687`*^9}, 3.639246578231823*^9, {
   3.6392467757232943`*^9, 3.6392467809995112`*^9}, {3.639247011981043*^9, 
   3.639247019479375*^9}, 3.6392826488507195`*^9, {3.639287540406839*^9, 
   3.639287551202058*^9}, 3.639297488883731*^9, {3.6392978092146935`*^9, 
   3.6392978129899*^9}, {3.6393006519764867`*^9, 3.639300653286889*^9}, 
   3.6393031652374372`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "742"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "757"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572205425497*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "776"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.6395722151483145`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EintDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Eint", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6392972694693456`*^9, 3.6392973666575165`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "EintDistr", "]"}]], "Input",
 CellChangeTimes->{{3.6392973697931213`*^9, 3.6392973754559317`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
C0CYsHXkr4vIP9E43q45T1pTvtWjXHrbJbuG9q9kIcRldYyoD2T7fyEEVV2c
ZmvyfyHGj9WzTYdLST+yeXX7I59vkP6FIMxOzHTW9CX/UR429MKxJi1JP7J6
xWLf93Qe65GtnY57im9p/ReBaDVvjvl9tv8XgU3CT7e6T2T6F4Hz0QVrtrH5
Ui4CSdZj90x1FelH3jAl4rEnjadBLkmbm3LwA+3/RWC5vGH3ChY/epTb7t16
oJzyvUSF/qW9W7OSzh8psm7T69NjKf5lKrKD8oVcBTvCPS+Vm+ZHBcX3rt6d
z+JFoYKcdsf900zxqgJXy6OyXqy+V6kg+5J1m+5MLqig68GXxdbMP7UKnKR+
LW+w81Wjgu1hx58cYqzl7BE51nGsV8EEh6NHG5i9BhVsHrXXapTpfhYBLQfO
UE9m8SuNALeq3/7uz+5DsgiQ1He+m72Q4kceAdeT3w4zZ+0horE+BcdKZPNr
04U/aL1UyNLquNYfaX4FZE3+3DVqOq/VyJWZQ+/vJ9Yg28XeuTuV9pc2AmCn
dmm3bmx/o3znrqudXTuS/8jbem5ZdJziQ498+rXZWWfKLwbOPkkkxF6e2+co
mw9pJO6ftV3vtLhK64+snd+2rA/Ve3Jk2WjF8N4kB2Rl+vVxHa99ZQWyocXj
w+/IP2VkY32qyMb5UohsXD+oI8EsTJeawtZLg/3l0yU33Sm/a43j69b8WX6J
9jeyONW8jZLs0Rnt/X3h4A80f/pIEPo52Z1P+fHreAaUQ0CXVhZ0nkqiQJLh
OP/Yp2/Jf+TwVW6Wl2m+ZVEg+Hl1abKP+sujGtsLUdDOe1aHD2z/KrC/wmLh
rkzmP3JNZLfz+8k+FXJpW+W2CIo/Adlw7HboEbb+yEFTQ1wH0LuTBrnOZfFn
C8rPWmSl88EsR7qviFFwp2HlitDppF8XBVN755abm+Id22sqv8kJofrCgFwS
d273HjqvJdG4npfCQjc9oPhHdlWtPXSMzhtZNIj7rjwd34neveTRIPwxP6K2
lL2TYXttuTxAQ/tLEQ1Xll36j0HB4h/bVx0KWcPWW4Xtc5Zvzal/SP4jF4/a
aTOIzl91NPwvfTJ/NCiPerj8sQvb/9GQN3dHx5Gm8wXlyph/y25QPaqLBmXU
1mH395N9+mi4BS08fmX5x4DyiI+dipg9khi0v199nwbqL0We3in9UBa9e8qQ
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
MtZ3+4bVpNJ7rTmypEvg7s30fUmK7LOj04ou9P5mndzYHlkyaIOy+19j55E9
ysFJ4fiF8okcuTCvfGc82eOIbHvcbN4S0g/JAJM6QFtLuq+5o1yscD+9nOph
RbLxe+AP8z7Q+6kPsszXr9NN9j0iGW7ZrLFYyvJBcDJ4eu0d0t1Ub2J7/aYP
Q6rJnnjktPtDRvZl909kd6vs5juIs5JhzZmPQy1N71FGez7VFrwieQ6y9b7D
b/xZfYpcbD1gU1Oq7/K5+dEmQ32pWNPOtP4oj+66NojlJ9HY32NWri+9D5Yk
w8z2AT1+N93nUO5b9/GJgeK70jj+my8elyke9cb5XjwlbAzd72uQ56labmpB
9ZQhGWR+fcvKt9F4dclwvL7WMdf0/p2Cf/t3C1pB8WuOnF9fu+wSjS9FlqUM
iPEk+6yRR11v29SS7r8yZMf5HqpCym/2yNqiIxOX0nupHNmwKLy1L+U7xxSA
utQXywNYHk2B3wf0+utHNt/u2L7yQI1NFZ3XCqN9g4uVesrXPshQvD9nINmn
RLYc5uQ8gerXYOR7viFjveh+okL2Ohi/IZC+H8YjC7KrF07S924B2env944+
tD+yUhqvnzoFPg2+c/YUi8cco9yqXd8H7HxGbvbFrXQi9c9HrnL97ZiW8p3W
OB/FDvIqev8rRFYH+HlsJ/tFZLfrqbUTyd4S5A9O+f36UP2iQ47/LsjvDa1n
ZQqUhAXNrWX5UM/ZW8OxIQVOnyzbn8vyXx0nl6Q2ZnOOpamw/mwT5zbs+711
Kux5nevXZh6rj1F+ofq9lcDin+sv59iRY0iFVvJqC09WT7lzckUqrFnYYWAc
ix+fVKhef2iJr+l7bCq86vT0zljGwalQENbpagu2v1Wp4Gvj73CBxVM8jj/B
eX02u18KyPnTN3ipKJ9kIYtt+iXfJrka2bwhSu5M+z0H2bBjS4Ef1Y8ao72T
xrwPp/o2H1lVZxubR6xNheJ1dY7VzL9Czj8RWW87YeIV2g8lyB1W2ticpfyo
Q9YsL18aRPVipbG/W9zRsZSP9Ua594xD5+j3AjVG/TPTpkno/cGALJ+4JOET
jVeXCpb9r4Y6mH5/kwZmo5p37cjm1zwN83V0cbYV5TspsnL4mZznlF+s00CQ
l2eXbKP7lgzlWTsKXnnTfNkj24YM23OW6hN5GsTu+v62B6uPHbG/x8NRZc6d
aR7SGs+HexqoHgR858fmS4Hy/J8Kl1yk8X2Q3/9y+WMRi38c767nvj2+dF8N
RnnwhGIPdt9VIccHXlndi9YrHhlmO859yL6fILv//eDAW8p/WZw96jTIX7di
LzB7clA+QbOv7mf2vQm5m8f7izvp/MpH1ruefh1O+UqLbH/HuZ833WcLjf6c
q7g8kPKbiOz44HxRFOkvQVZVPamR0u8TdJw9lWkwzen1q/vs+6ge5eKMacPr
6HyoQfa5PHndLsrXBuShHkp5xDdf29cZ1xdilqWw+386nj/Nxv6UR/nTPB1i
sx5Z3ZzE7oMo/yX0epc5lD+t0xvbI0uHjF8F6Rb2fdAe5Tmn5yWY0e8L5MiK
8BsFrL51RC6MuLf3Ed13AFlb6pgfSvPhjnxsh8OwQFpvBbL1p4JAf8qvPsjx
Wd+fVdDvTpWcPcHpsCW9bIo/qw9VnDyeY4HjLI7VHOdwrEmH2u62z7Xs93f5
nFzLcSHHIsclHOvSYXRu6t1CFp+V6aCpHPWfpqb3nXQ4/7LUT2T5riYdnBaW
zrnP8qEhHZ6u81q2l52vddz4kozGbJ4B4dc0FuVsfCknt86AT7sr1GdNvxfK
gGb9TteWs/HtM6C04sXb35h+eQZ49nRZfZXJHTNgve3KvxNM38+48d05VnDs
kwGCjTrnQwbL/xnQ7s3uq82ZPcEZ8GJE3c1aU/2XATYVNiHtmT/xGY3zkcCN
n8WxmuMcjjUZsH/UstfhTF8++u9X8c8Y03tNBhg67hl/2JT/uf5iBjz+5jvX
uax/CSfXcVzJsT4Dhrl9cVSx3y/XZMCmb/JXeTL9hgwIbpjSUMq4LgPeXrq2
M9lU/2WCp/WVP08xuXkm6HXfOWew9ZJmNtZnzbGMY/tMyCiZc7h/f7JHzskd
M6GFu/s6FZt/yIRl6X8VZzJ73DMhfPAAP9P7loLr78OxkuPgTNjm5flmmgPp
V3Hy+EyIHH6t+1vT98dM+FFz1iGCcVYmWNyU2ndn+VWdCeb9/z51g+W3HBzv
3zd2D/Ppfqzhxs/nWMtxIcdiJtg3XBtkus+VZMKRsJF/rjW952WC1f4emmZs
PiozYVqm4ozp+5c+EyyDalNHsvWqwfX0K7IaaHrv4/TVcSzJaszmHEs5tuZY
xrE9x3KOHf+f/w/6a0yz
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 775.}, {0, 1000.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.639297375986333*^9, 3.6392976201735616`*^9, 
  3.6392978935328417`*^9, 3.6393007244074135`*^9, 3.6393032026619034`*^9, 
  3.6395722157879157`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdataDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Edata", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639297389714357*^9, 3.6392973985283723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", "EdataDistr", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.639297406874387*^9, 3.639297423394816*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxd1ndcDfz/PvAjK7e7ZGen28hKSIXUpUSira2hpd1pnU777BPRHWVlFFpW
ZVVGOtwiJJKQVRQ3WaHI/vZ73O/XH7+Pfzye3r26znWuf0z0DrfzU+JwOP17
czj/7+///nQY71jVrK/tGgf2D1A7aVJotlbErIxRa6w8GvtImNXwLbjKvH8J
eRjcJ3mdVnBlzOrYzp0gub6fPBbVR+5xHz0ka6Ddy/rOkHdkTQh/NtTuspIz
T8KTRXZGi46Qp6B6WsPisi9kLaQqoqPDOKnM0zFzqUe86kDyTOx+VBXVPous
DZ89ijESY7IOlgVyGjItyXOwJubqkoFx5Llw8FGZK9hAnodpJpuNvqWRdXFq
hMHkpfvI8xG10akxrZCsh3FWT4QXSsj6uHSy0dzqH7IBlJ2uXFp1hbwA7e+V
vj26QV6IfhZDN8lekhfhc+4B99bXZEOMT+2Yo+gkL8Yt6+e7Z/8iGyHucfLI
8t9kY8TXBeR/U1/PDMi/Ty/L12AWAKtuf3udMInel8BIdMdrqwW9L4Fy4Jpt
qjb0boJmPdW+21bTuwlmPrnZ8oHMMcWPJ9JsmSO9m+LFipzAP93pfSn+CrQO
Dfei96WQG4dsaw+hdzNc0+CYbRbTuxl4nrc2PpfS+zIcu5bb26SQ3pfhkKtZ
/4dF9L4cLQOalLWO0/tyjHxqtc/pHL2bY1dD5WNTBb2bQ/PqhrjEC/S+Ak19
c5bdraX3FcjSvqda94LeLbB18yL19O/0bgHThJGqrX03sPeVUFYP7B7Rj1mw
EitGanSu/5PeV0Hh/eFgf1V6X4UL0GwIH0HvluDE3dRunUrvljhb9s5bMoPe
raAWnh9+y5DerZCpPio+25zerRHXOSWzxpberVHkaNawwIfebYDbdtdT/Jlh
g85NHpUtgfTzNj0/nxbiEsqssMGWbZsXCXh0b4tHauNXD8ike1vsX2PoO34X
3dsibcneNXdy6N4WRa+CZOn76d4Oxx89Vd6fR/d2qG3i5009Svd2EIbkzfuH
rLDDmNGbvP6sont7rEzdUMutpnt7jI5fLj9wh+7tUVYcF7vzHt3bY/jscK0x
9+l+NfyHnq+c3UT3q3E7b5B233a6X40H75f7DnxN96uhfSbkOJ/McYDan1vy
zLvo3gEte3ccNP1M9w448yLyXvKANHbvgJAL51ujRzJzHHH+HGdX4ShmOEK3
Qbu8QpNZ4IjgqWtGW+nSvSNW6VoHFM6neyesKU9NCtaneyd8nu1ft3w53Tuh
+5S3zqoVdO+ECsMLnHcr6d4Z02vqSkVWdO+MUTr1W0rt6d4Z8Tbpf+5yoXtn
VBVVVN/1oHsXJG1R/1zkQ/cuMNA4/hf86d4Fx8cZFw4OonsXPN+6pOIFmeOK
3eMsh80Ip3tXjGvf4LSKT/eu+Heg3oAbZIUrYoctdM2Mp3s3LIjeXP4rme7d
8Et1w3Y/Cd27weSSyrRlMrp3w/rfliPmptL9Gpj2P95rYBrdr0G8RYJpcRbd
r8Gjy32nfNhB92vgsjz1s2oO3bvjmkQxd1ge3btDaddvl2yywB0Gbzxt7uXT
vTu6RcOrTAro3gMH3k9qeXiC7j2Q18tn3YcKuvfAZ6Upuhan6d4DTds7rzaf
oXtPbKnO5dddoXtP9NH13i6uoXtP1P0u3Gd0je494Z/B8Z1VR/deOHTOWC/n
FrOGF4p/5UVPekK/zwtqix/X5TQze3nBN7i4QqmFfr8XFLNryw48Y871QsMs
vm7WK8rzQqdBRX3gR+YWL6jqGJuGfaX8tfB9fPx78A/KX4uIybGjP/+m/LWw
K6nTVe+9keWvRWdKn0bVvsyCtbjcNODCin7MuWuR+0YleKsys2It8jx/i0MH
MLf03PfZUBc8ipnjjaWra3Zqj2PW8MbhoR/lWyYywxvaI1f+2Dad8r0xnDNv
q/NMyvdGiCFPb9EsyvdG5+zI/Nl6lO+Nz6nd5VdWUr435pssLvhI5vjAwuLj
wROrKN8Hq1R4f3laUr4PzK38FZY2lO+DtITly9RtKd8HjiPdTp23p3wfRL/J
1s/woHwfDJkzWsXBk/J9EDJm6KC9XpTvixeX9rUkB1C+L5od+m8vD6N8X3wd
XVCSEkX5vvj0Pik+OJryfTHzuMmgt+RcX3Tefzb3cSzl97iov4gnoHxfcNP3
nT9B5vhho//sshsiyvfD2SkV7goJ5fsh6SQvI3sD5fvhZEv7JfUcyvdDtX3l
4PEHKN8P3PrjZ+eTFX7YcmdWpMVByvfDP1YDjIoOUb4/5jZKzlaTNfzxaeRN
95FHKN8f/YzPHuaXUL4/XgakK9mWUb4/jhzJGXO4kvL94Vd1KSzsPOX7I60p
1a/yAuX7Q1vkuAUXKX8dLqSHPPW4SvnrYGUfurdXPeWvw7lzB2fU3qb8dRg0
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
v7Hkopsz9efjouYMpTVkNT46/8491+RG/fkYyHM12O9H/fmobV4ecIpL/fmY
GyYXvYqk/nxY7HZaszSK+vMxvSBHOI9P/fngxkyc0See+vORnx1WtT2B+vMx
5MojUWES9ecj5JZb2R0R9eejb8SSpc0S6s/HvCZjmYOU+vNx28X2zuUN1J8P
0aS1XjvTqD8fRrJK3WdkThzSP/g9WpBB/eMgUtea47mF+sdhbUeOyrNt1D8O
u/Y4ta3eSf3jcGMmZ0FUNvWPg2GLcRV2U/84qNaPanu6l/r3/L7tcuWcfOof
h+KWPdxickYcMj+NeFNwlPrHoTu2i/93MfWPQz/9B30XlFD/OCi6Jq3bTb4V
h97qE7/vP0b94+Ds9qO24zj1j8MEndXGXqeofzyshztc3llO/eOhfXXsgwnn
qH88pm2NmeF2ifrHY4/bdscL1dQ/Hs529YZjrlD/ePSV3Jt2t4b6x2PbsKt8
6W3qH4/Y2puZ3HvUPx77Po3teETOiIdRZ8Gm84+ofzxO3HyaWfiM+sejT5jP
l3qyIh6fjSN3xLyg/vHwmqE0RvNf6h8PlVt/dyW8pP7xSBysMafXJ+qfAJeE
/VLXTuqfAKuwTv3AburfY6RLX5F1EsBLNTQd8JX6J6D6atlnt2/UPwEpejmm
7pwM1j8B3z8XGeUoMXMT0PHx7ymHyYIEHBeOX3GRnJGAn/nuPK1+zLkJ0Jra
8VaPXJqAmh2nTA/3Z1YkQL0hv0zpD+ZbCfAuPD/2ILklAfOMzvFOkzsScEJP
w2PgQGZOIgqMvH+a/smslojBGaML7FSZNRJRdO/d3rmDmXUSMWDShQM+Q5iR
iMwli4+sJ9skIrQ7vXH0UOqfCPg/XWY9ivon4g3n2c/Q0dQ/EdZ1wzyOkDMS
sf91ywybsdQ/EeNr8kME5NJEDOybNNxsHPVPhIFN3NBc8q3Env8vPLx/dQL1
T4RbQ03eu7+ofyLqplY7ZE+i/knoKF18dcdk6p8Ef4d7fRVkjSQsGxJWbzqL
+ifBLqhv1crZ1D8J3VkXd/eZQ/2T4NOiWP8H2SsJoZEOxTfJ3CRkWwyX/J5P
/ZNw7fncjCg96p+EkWf+WHeOnJuE6YOdPsYsoP5JiO915ex1siIJ1k9eCXcv
ov5J2L12SEzmYuqfBN385BUl5I4kjFP3diwyov7J2G49OOkEqH8yJK8Xz2sn
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
KjKqLjSa1W7H/wF1sdOI
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 775.}, {0, 1523.068198230092}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6392974079663887`*^9, 3.639297423878417*^9}, 
   3.6392976283479757`*^9, 3.6392978978384495`*^9, 3.6393007251406155`*^9, 
   3.63930320653071*^9, 3.639572216349517*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Energy", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6392977934430656`*^9, 3.6392977988406754`*^9}, {
  3.6392979060284634`*^9, 3.639297910162471*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 1.457857375887985*^6}, {2., 1.0436180545674872`*^6}, {3., 
      1.0195506314043195`*^6}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 997635.2941801362},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 3.}, {1.0195506314043195`*^6, 1.457857375887985*^6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6392977991526756`*^9, {3.6392979005372543`*^9, 3.6392979105524716`*^9}, 
   3.639300725171815*^9, 3.6393032089019136`*^9, 3.639572216380717*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1261, 1382},
WindowMargins->{{Automatic, 39}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2385, 59, 112, "Input"],
Cell[2968, 83, 569, 9, 31, "Output"]
}, Open  ]],
Cell[3552, 95, 4884, 116, 132, "Input"],
Cell[CellGroupData[{
Cell[8461, 215, 106, 1, 43, "Subsection"],
Cell[8570, 218, 10844, 244, 766, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19451, 467, 112, 1, 43, "Subsection"],
Cell[19566, 470, 3793, 75, 206, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23396, 550, 108, 1, 43, "Subsection"],
Cell[23507, 553, 8866, 198, 600, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32410, 756, 105, 1, 43, "Subsection"],
Cell[32518, 759, 14748, 292, 1152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47303, 1056, 106, 1, 43, "Subsection"],
Cell[47412, 1059, 12423, 252, 1172, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59872, 1316, 98, 1, 43, "Subsection"],
Cell[59973, 1319, 6625, 116, 392, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66635, 1440, 99, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[66759, 1445, 8540, 178, 532, "Input"],
Cell[CellGroupData[{
Cell[75324, 1627, 140, 3, 23, "Print"],
Cell[75467, 1632, 140, 3, 23, "Print"],
Cell[75610, 1637, 142, 3, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[75779, 1644, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[77133, 1685, 139, 2, 31, "Input"],
Cell[77275, 1689, 9488, 167, 237, "Output"]
}, Open  ]],
Cell[86778, 1859, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[88132, 1900, 167, 3, 31, "Input"],
Cell[88302, 1905, 10805, 188, 237, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99144, 2098, 250, 5, 31, "Input"],
Cell[99397, 2105, 1114, 28, 228, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
