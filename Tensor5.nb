(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    107626,       2311]
NotebookOptionsPosition[    105795,       2245]
NotebookOutlinePosition[    106144,       2260]
CellTagsIndexPosition[    106101,       2257]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorData", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
    "Import", "[", 
     "\"\<C:\\\\ETH\\\\Neuro\\\\GlobalTracking\\\\GlobalTrackingScripts\\\\\
tensor_data.txt\>\"", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"dim", "=", 
  RowBox[{"Dimensions", "[", "TensorData", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Tensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "6"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6376408711401596`*^9, 3.63764090944243*^9}, {
  3.637642223442727*^9, 3.637642224035528*^9}, {3.637642588013631*^9, 
  3.6376425897452335`*^9}, {3.6376427209040656`*^9, 3.6376427701155524`*^9}, {
  3.6376428653375206`*^9, 3.637642901132984*^9}, {3.6376430845609083`*^9, 
  3.6376431307283897`*^9}, {3.6376431863066874`*^9, 3.6376431866342883`*^9}, {
  3.6376436659501348`*^9, 3.637643671285344*^9}, {3.638016044529835*^9, 
  3.6380160579776044`*^9}, {3.638022352874652*^9, 3.638022357140896*^9}, {
  3.638026101989089*^9, 3.6380261058433094`*^9}, {3.6380295187905188`*^9, 
  3.638029591439674*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9", ",", "9", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6386947448877144`*^9, 3.6387265492276173`*^9, 
  3.6387691619472556`*^9, 3.638778407116049*^9, 3.6387840076943836`*^9, 
  3.638846436643702*^9, 3.6388481010602264`*^9, 3.638848734984867*^9, 
  3.638869857688972*^9, 3.6388705145905256`*^9, 3.638870866995145*^9, 
  3.639234454604957*^9, 3.6392440159317846`*^9, 3.6392826506447225`*^9, 
  3.6392857231432467`*^9, 3.639292521978692*^9, 3.639300656656495*^9, 
  3.639303123335764*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", "vec_", "]"}], ":=", 
   RowBox[{"{", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "   ", 
     ",", "   ", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "   ", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SurfacePositions", " ", "=", " ", 
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.639300281210635*^9, 
   3.6393003142982936`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.6392936406098566`*^9, 3.6392936450558643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"E0init_", ",", "\[Alpha]maxinit_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]max", " ", "=", " ", "\[Alpha]maxinit"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"E0", " ", "=", "E0init"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Surface", " ", "=", " ", 
     RowBox[{"Select", "[", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
        "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"S", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"S", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "Pi"}]}], "}"}], "]"}], ",", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "*)"}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<tensor\>\"", "->", 
               RowBox[{"Tensor", "[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<direction\>\"", "->", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
               RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "1"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kk", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<forward\>\"", "->", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<backward\>\"", "->", 
               RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"A", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<tensor\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<direction\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<forward\>\"", "->", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<backward\>\"", "->", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.6393002972786636`*^9, 
   3.6393002976218643`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neighborhood Functions", "Subsection",
 CellChangeTimes->{{3.6392936149010115`*^9, 3.639293620953822*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        ">", "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", "spin_", "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}], 
         ")"}], ".", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], "<=",
        "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Functions", "Subsection",
 CellChangeTimes->{{3.6392936023897896`*^9, 3.6392936060245957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"backward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"backward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "backward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "backward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"forward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "forward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "forward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], " ", "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], " ", "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"Surface", ",", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         FractionBox["E0", "2."], " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"Log", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
               ",", 
               FractionBox[
                RowBox[{"cos\[Alpha]", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                RowBox[{"1", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"E0", " ", "+", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["E0", "4."]}], "-", 
            RowBox[{"Log", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"cos\[Alpha]", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], 
               ",", 
               FractionBox[
                RowBox[{"cos\[Alpha]", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
                RowBox[{"1", "-", 
                 RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "6"}]}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Edata", "[", "spin_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], ".", 
   RowBox[{"Inverse", "[", 
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<tensor\>\"", "]"}], "]"}], 
   ".", 
   RowBox[{
    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.63929410027643*^9, 3.639294147497713*^9}, {3.6392945813968754`*^9, 
   3.6392946417221813`*^9}, {3.639296628969*^9, 3.639296632198206*^9}, {
   3.6393001043219247`*^9, 3.639300134679578*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create New Spin", "Subsection",
 CellChangeTimes->{{3.639293662886696*^9, 3.6392936685651054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateNew", "[", 
   RowBox[{"str_", ",", "spin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newposition", ",", "newforward", ",", "newbackward", ",", "newID"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"str", " ", "\[Equal]", " ", "\"\<forward\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "+", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "->", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", "spin"}]}], "}"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"newforward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
           " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newforward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newforward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newforward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
         "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "\[Rule]", "spin"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", 
                 RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"newbackward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
           " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newbackward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newbackward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newbackward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392954013625145`*^9, 3.639295402984917*^9}, {
   3.6393002043337*^9, 3.639300208124507*^9}, {3.6393002499637804`*^9, 
   3.639300267217411*^9}, {3.6393003300543213`*^9, 3.639300367509987*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Associate Spin", "Subsection",
 CellChangeTimes->{{3.6392936975499563`*^9, 3.6392937056307707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Associate", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "oldforward", ",", "oldbackward", ",", "forwardneighbors", ",", 
      "backwardneighbors", ",", 
      RowBox[{"minforward", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"minbackward", "=", 
       RowBox[{"{", "}"}]}], ",", "E0", ",", "E1", ",", "\[CapitalDelta]E", 
      ",", "p"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"forwardneighbors", " ", "=", " ", 
      RowBox[{"F", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]E", " ", "=", "0."}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"oldforward", " ", "=", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"oldbackward", "=", 
         RowBox[{
          RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"E0", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
          RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", " ", 
          RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"E1", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
          RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
          RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"E1", "-", "E0"}], "<=", "\[CapitalDelta]E"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalDelta]E", " ", "=", " ", 
            RowBox[{"E1", "-", "E0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"minforward", " ", "=", " ", "newforward"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
            " ", "=", " ", "oldforward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "oldbackward"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
            " ", "=", " ", "oldforward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "oldbackward"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"newforward", ",", "forwardneighbors"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "\[CapitalDelta]E"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], "<", " ", "p"}], " ", "&&", " ", 
        RowBox[{"minforward", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", "minforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "minforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "==="}], "="}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"backwardneighbors", " ", "=", " ", 
      RowBox[{"B", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]E", " ", "=", "0."}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"oldforward", " ", "=", 
         RowBox[{
          RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"oldbackward", "=", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"E0", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
          RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", " ", 
          RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"E1", " ", "=", " ", 
         RowBox[{
          RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
          RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
          RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"E1", "-", "E0"}], "<=", "\[CapitalDelta]E"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalDelta]E", " ", "=", " ", 
            RowBox[{"E1", "-", "E0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"minbackward", " ", "=", " ", "newbackward"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "newbackward"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
            " ", "=", " ", "oldbackward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "oldforward"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
             "]"}], " ", "=", " ", "newbackward"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
            " ", "=", " ", "oldbackward"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
             "]"}], " ", "=", " ", "oldforward"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"newbackward", ",", "backwardneighbors"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "\[CapitalDelta]E"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RandomReal", "[", "]"}], "<", " ", "p"}], " ", "&&", " ", 
        RowBox[{"minbackward", " ", "\[NotEqual]", " ", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", "minbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "minbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CreateNew", "[", 
         RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.639295315733964*^9, 3.639295323128377*^9}, {
   3.6392953553112335`*^9, 3.6392953706460605`*^9}, {3.6392964505982866`*^9, 
   3.639296515712801*^9}, {3.6392965903433323`*^9, 3.639296615053776*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Align Spin", "Subsection",
 CellChangeTimes->{{3.639293712900384*^9, 3.639293715380788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Align", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newdirection", ",", "olddirection", ",", "E0", ",", "E1", ",", "p"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"olddirection", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newdirection", " ", "=", "  ", 
      RowBox[{"olddirection", " ", "+", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}], ",", "3"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newdirection", "=", 
      RowBox[{"newdirection", "/", 
       RowBox[{"Norm", "[", "newdirection", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], "=", 
      "newdirection"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ">", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         "=", "olddirection"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392953793196754`*^9, 3.639295386402088*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 CellChangeTimes->{{3.6392937224788003`*^9, 3.6392937236644025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Energy", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{
    RowBox[{"10", "^", "3."}], ",", 
    RowBox[{"Pi", "/", "3."}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "n", ",", "s", ",", 
     RowBox[{"N", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "\[LessEqual]", "N"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Energy", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"Energy", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Eint", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}], "+", 
             RowBox[{"Edata", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "2"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "2"}], ",", 
              RowBox[{"k", "<", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Associate", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "<=", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Align", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "}"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6387265850926685`*^9, 3.6387266182545652`*^9}, {
   3.6387266547656536`*^9, 3.638726730015958*^9}, {3.638726767279089*^9, 
   3.6387268341269126`*^9}, {3.638728996310582*^9, 3.638728998703719*^9}, {
   3.638774777993475*^9, 3.638774796595539*^9}, 3.6387758845047636`*^9, {
   3.6387765618485055`*^9, 3.6387765648386765`*^9}, {3.6387766067520742`*^9, 
   3.6387766089281983`*^9}, {3.6387767545385265`*^9, 3.638776780083988*^9}, {
   3.638776871456214*^9, 3.6387768987137733`*^9}, {3.6387769612843523`*^9, 
   3.6387769751051426`*^9}, {3.6387770351615777`*^9, 
   3.6387770446761217`*^9}, {3.638780724314585*^9, 3.6387808244323115`*^9}, {
   3.6387808660246906`*^9, 3.6387808743601675`*^9}, {3.6387811093806095`*^9, 
   3.6387811422604904`*^9}, {3.6387813280711184`*^9, 
   3.6387814042754765`*^9}, {3.638781445752849*^9, 3.638781497681819*^9}, {
   3.638781740086684*^9, 3.6387818031062884`*^9}, {3.6387818667979317`*^9, 
   3.638781870587148*^9}, 3.6387820216447883`*^9, {3.638782085824459*^9, 
   3.638782089326659*^9}, {3.6387831847253127`*^9, 3.6387832302659173`*^9}, {
   3.638783265513933*^9, 3.6387833131676593`*^9}, 3.638783569945346*^9, {
   3.6387836932844005`*^9, 3.638783694868491*^9}, {3.6387861824447727`*^9, 
   3.6387861925063477`*^9}, {3.6387867726195283`*^9, 3.638786775172674*^9}, {
   3.6388464914933987`*^9, 3.6388465005414143`*^9}, {3.638846557481514*^9, 
   3.638846576731948*^9}, 3.6388468052063503`*^9, 3.638846942658191*^9, {
   3.6388470085215073`*^9, 3.638847011345112*^9}, {3.6388471927422304`*^9, 
   3.638847229917096*^9}, 3.638847460469901*^9, 3.638847581884914*^9, 
   3.638847694595112*^9, {3.6388477898800793`*^9, 3.638847806743709*^9}, 
   3.638847888222652*^9, {3.6388485203276405`*^9, 3.638848521560043*^9}, 
   3.638850034504409*^9, 3.638850213632795*^9, {3.6388699844391947`*^9, 
   3.638869997636818*^9}, 3.638870630311529*^9, 3.6388708769167624`*^9, {
   3.639234514585757*^9, 3.639234563757043*^9}, {3.639234947194609*^9, 
   3.639234955743424*^9}, {3.63923546768025*^9, 3.639235468023451*^9}, {
   3.6392360164170647`*^9, 3.639236016588665*^9}, 3.639238108190928*^9, 
   3.639238398623765*^9, {3.6392385528340964`*^9, 3.6392385590333076`*^9}, 
   3.6392399812938576`*^9, 3.6392439279164295`*^9, 3.6392439599744864`*^9, {
   3.6392448967901106`*^9, 3.6392449727211046`*^9}, {3.6392450773972883`*^9, 
   3.6392451264593744`*^9}, {3.6392453496645665`*^9, 
   3.6392453693830013`*^9}, {3.6392454954312224`*^9, 3.639245501796034*^9}, {
   3.6392461241918774`*^9, 3.6392461533090687`*^9}, 3.639246578231823*^9, {
   3.6392467757232943`*^9, 3.6392467809995112`*^9}, {3.639247011981043*^9, 
   3.639247019479375*^9}, 3.6392826488507195`*^9, {3.639287540406839*^9, 
   3.639287551202058*^9}, 3.639297488883731*^9, {3.6392978092146935`*^9, 
   3.6392978129899*^9}, {3.6393006519764867`*^9, 3.639300653286889*^9}, 
   3.6393031652374372`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "742"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "757"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031863286743`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "778"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031974826937`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EintDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Eint", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6392972694693456`*^9, 3.6392973666575165`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "EintDistr", "]"}]], "Input",
 CellChangeTimes->{{3.6392973697931213`*^9, 3.6392973754559317`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 777.}, {0, 1000.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.639297375986333*^9, 3.6392976201735616`*^9, 
  3.6392978935328417`*^9, 3.6393007244074135`*^9, 3.6393032026619034`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdataDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Edata", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639297389714357*^9, 3.6392973985283723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", "EdataDistr", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.639297406874387*^9, 3.639297423394816*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxd1nc8Ffr/B3ANpZS0tV0tDRlJRLxCJUmyIuLYI+M49j77KJKiqGQlaZe6
SIOW1EXc0i5Ki5aWtH9+j/t5//O9/9zH8368z8vrvB6P+/CXZ6itT185OblB
/eTk/v/f//3TZbJ/TvAQWUAs2H9Ag89kwfEAIbMCrPYUmw3+I2JWRteUwF9p
pWLmUVg/jXO6hitlVsGappH3bu0mT8SVw3e4Dx+QVdHJWX1rxDuyGjperNK7
7ShjnobHhrbGhofJM3Bl1s3F5V/J6kipiYgIkUthno255m5xSorkuch9WB3e
qUGeB689NRPEJmQtLAuQu5m5iqyNietr+yvFkXUwy3Sr8fdU8nyE/Ro4KzKN
rIu/x+hPNy8kL8Ak68eCC8fIenjww2SoaQV5IXItD03bf4Gsj8unWiysL5EN
0Pm+7/eHDeRFGGA5crP0FdkQ3QV717e/JhthckqXds1n8mKcumlwzvkX2RhN
q5/nav4mm+BRxaJSw4kbmQHZj9nl+1SZ+cDufnt1hHPofQmMhbc42y3pfQkU
Alx3KNnQuylU143/fteO3k0xb+Ks38/s6d0M5V+GbCt3oHcz/Hws2SV1pHdz
VB2wmd/pS+/mkJkE7egMovelSE3ZsfyDkN6XIsq9Ke25hN6XwSukUndPEb0v
w4nrBf1M99P7cswc8vqQ+AC9L0e1wTSbkip6twDXg7dh8Hl6t4DatU2xCRfo
fQW6qtuTqq7Q+wrck89fdrue3i2RNe+OUuMLerdEmEW2UVA3va+Ebbb3K6Pf
9L4Sl9ISRp0dtIm9W2HFWNXPG4cw861wAWo3Q8fQ+yqcKX/nKZ5D76ugwPEY
emQBvVtDOXRfaJMRvVvD2ef6yc1L6X015nWmmgywovfVKHVcetPAi95tgH9t
/0n2ZYYNPm92O9cWQD9v0/vzqUHOwcw1Nti2Y6shP4ru1yAldOX1wu10vwZF
rkbek3fT/RqkLslzvZVP92vgLx6sN6+Y7m1R9vCJQhEZtqi/F1M88wjd20IQ
VDz/ErnGFhPGb+YMqaZ7O4yPWy7be4vu7dAjHj6+p4Xu7VB+NDZ65x26t8PT
d5sudt2ne3uY/tk6I+cx3dtDJ09Xa94rurfH/ffLvRVf07095lUFlcWQ5Ryg
PGRbscUXundAW17OAbNuundA1QvenaRBqezeAXf7B7f1HcEs54jUsphcr1HM
cAR3N+/NySnMfEfo3pxXUalG944YlRnlnKVD92uhUOGgMsyA7teiW9O3cfly
ul+Lnr89taxW0P1aVBpdkHu3ku6dMLuu8bjQmu6dME6redtxO7p3QpxN+pDd
znTvhOrSyiu33ejeGYnbVLpLvejeGfqqZVPhS/fOcNXu+2h0AN07o2ySyf7h
gXS/DrmTVo2aE0r36zDumlehF5m/Dhu/nfomF07369Duda2zMJLuXTCpc9Na
qxi6d8FLRb1BDWS+C34rbcr2EdO9C2as2OCpKaV7V5heHjprGRmusE86YpiW
SfeueFgrP+NDDt27wnl5SrdSPt2vx+C4Lj0ZGetxXVyjM6qY7tdD/427zZ19
dL8eUyt+6Rw9Rvdu8C1e655fQfduKO7j5fehku7d0N13hq7labp3w73sz9da
q+jeHf6Zn/8sOEf37uiv65ktqqN7dzT+2V9ofJ3u3eGbIeet0Uj3HBw8a6KX
38SsysHR38UR0x7T53GgvPhRY34rM4cD7w1HK/u20edzUKNZX773KXMBBzc1
YnSzOiiPg7L2tqNe35jbOFDSMjELIct5wPtR2Y8NPynfA9u1fz651S+N5Xvg
c3L/FiV5Zo4Hau8NurBiADPfA/ft5yraKjAXeKDgzdAN28k1Hih2/yMKHsTc
5gH9kr37zcYyy3nic/9NjRvGMat6IqNxi6LnBMr3xLyxK3/umE35nhgtN3+7
01zK90SQUZSeoQbl936eJm+fph7le+Lozy9eOUaU74mad8Znlq2gfC90p/RU
XF1J+V6wtPx44KQV5XvBwtq3ZpUN5XshNX75MpU1lO8Fx7Euf5+3o3wvRLzZ
tTDDjfK9MEJ7/FAHd8r3QtCEkcPyOJTvjReXC9uS/CnfG5FRqikqIZTvjVaH
gdkVZI435paZDnsbQfneOLpJ5enSBMr3Bje98PxJPuV7Q8uz6eUZcps3lF3V
5VsFlO+DNF/N8gYh5fsgZlzYndiNlO+DxFNRGbs2Ub4PBmsZuinmUb4PTrV1
XlbJp3wfcJvLzizYS/k+KFs8SiFhH+X7YNstDZ7lAcr3xe7gEGfHI5Tvi6TF
3sPXHaN8X+jXtZXtKKN8X3TMOWjz8RTl++KVf3rfNeWU74vDh/MnHDpH+b5o
3nW/+uVlyveFysaa2Q9qKd8PgwNtSpyuUr4frO2C8/o0U74fvM2b3dNuUr4f
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
smoSslcPTzxJ1krCgLPYPMeM+vd6sGm/5mXUPwl9pknzwi2ofxI69/0Z6b+C
+idBzSnYedlK6p+EotqlH6OtqH8SggyqOq6uov5JqI1T0Yi3pv5JOPRxoMTV
ifonoev5tJp6clMSWrQmJrU7U/8kLFu4yTrfjfonQXQ2bfgwd+qfjOy7NhY5
ZOVkePjwL5pwqH8ybOqbXh/zoP7JeGty4r3Qk/onYzP/0riNZJtklP3IUb1C
5iRjUmfgs/de1D8ZVSffGCX6Uv9k6G2vv/uVnJGM8LPj+s/1o/7JEA8/MuoH
+XgyfAyUeuICqH8yHCYOrogNov69v2+OTuw1HvVPhtec9c86wql/MpyzcpcY
RFB/Pn6qutufjGRW4EO/68WI/Cj6PvhInfLBMjKWWYWPl4b2NefJqnwYtHTL
XyOr82Ge8SHvSjx9X3yMNRtRsziRWZ+P0EL77duS6PvjY9DKa1+nJjNb8BHz
4ftgMwF9n3xc1rOefEHE7MRHm/ydl+ky+n75CPJVV1bfyOzPx+0tqc4RZC4f
FcV225TTmGP4WPZtfszodPr++Xg4Y3E/3jbmFD6E9QndwZm0Bx8WWTemO2cz
5/ARX63QfopcwMf4Ved2bd7NXMpH42zJVtUi2ouPuc0lJ8zIlXwMaHzmspZc
w0fZrR97XYqZ6/g40WXX/LGE9uRjR/3iqn77me/ykTk88HsWuY2PgtUtW86T
X/ERp2boIjlIe/Ph3zLiqs9h5h4+VA8WXZAeo/0FGG52zmvacdpfgMmld/wu
kpUFGHymQyu8jPYXIF9SxZ1zkvYX4PHK84Mty2l/ARQ83zk2V9L+AnxbK5kb
e4b2F+DyjPi3M2to/97/00wbUzfpAu0vwKdlO+eLLtP+Ang5iVr9r9D+Amgr
XONxyRwBLCeZd+jU0f4COIa6WD65TvsL8LL4xB3HBtpfAGuXaYtwj/YX4BXH
7n0EOUWArF0lTsfIGQLsSf1k8fk+7S/Arn/UrA4/of0FUM3SXfDlKe0vwMTB
w1IMn9H+Avw6uPqLwXPav/fz56s9e0auEcC9xqnc5hXtL8DtQQqHL5CbBOj8
fPh5QCftL8BO7QsqLp9pfwGGxOx5r/yF9hdAPTDmyxNylwCcpPH3rnbT/v9j
OSG8KxK+63+l/YVIG3jqtVIP7S9EbfOmmbpkFSE81BrmTvpG+wtxjhutaPid
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
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 777.}, {0, 1513.6970359735585`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6392974079663887`*^9, 3.639297423878417*^9}, 
   3.6392976283479757`*^9, 3.6392978978384495`*^9, 3.6393007251406155`*^9, 
   3.63930320653071*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Energy", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6392977934430656`*^9, 3.6392977988406754`*^9}, {
  3.6392979060284634`*^9, 3.639297910162471*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 1.457857375887985*^6}, {2., 1.0436181540371975`*^6}, {3., 
      1.0180841516894542`*^6}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 996095.4904795277},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 3.}, {1.0180841516894542`*^6, 1.457857375887985*^6}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6392977991526756`*^9, {3.6392979005372543`*^9, 3.6392979105524716`*^9}, 
   3.639300725171815*^9, 3.6393032089019136`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1261, 863},
WindowMargins->{{Automatic, 497}, {Automatic, -951}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2385, 59, 112, "Input"],
Cell[2968, 83, 545, 9, 31, "Output"]
}, Open  ]],
Cell[3528, 95, 4884, 116, 132, "Input"],
Cell[CellGroupData[{
Cell[8437, 215, 106, 1, 43, "Subsection"],
Cell[8546, 218, 10844, 244, 772, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19427, 467, 112, 1, 43, "Subsection"],
Cell[19542, 470, 3793, 75, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23372, 550, 108, 1, 43, "Subsection"],
Cell[23483, 553, 8866, 198, 600, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32386, 756, 105, 1, 43, "Subsection"],
Cell[32494, 759, 14748, 292, 1152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47279, 1056, 106, 1, 43, "Subsection"],
Cell[47388, 1059, 17792, 361, 2032, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65217, 1425, 98, 1, 43, "Subsection"],
Cell[65318, 1428, 6625, 116, 392, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71980, 1549, 99, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[72104, 1554, 8540, 178, 532, "Input"],
Cell[CellGroupData[{
Cell[80669, 1736, 118, 3, 23, "Print"],
Cell[80790, 1741, 118, 3, 23, "Print"],
Cell[80911, 1746, 118, 3, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[81056, 1753, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[82410, 1794, 139, 2, 31, "Input"],
Cell[82552, 1798, 9485, 166, 237, "Output"]
}, Open  ]],
Cell[92052, 1967, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[93406, 2008, 167, 3, 31, "Input"],
Cell[93576, 2013, 10809, 188, 238, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104422, 2206, 250, 5, 31, "Input"],
Cell[104675, 2213, 1092, 28, 228, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
