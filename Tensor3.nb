(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72711,       1525]
NotebookOptionsPosition[     71750,       1490]
NotebookOutlinePosition[     72100,       1505]
CellTagsIndexPosition[     72057,       1502]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorData", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
    "Import", "[", 
     "\"\<C:\\\\ETH\\\\Neuro\\\\GlobalTracking\\\\GlobalTrackingScripts\\\\\
tensor_data.txt\>\"", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"dim", "=", 
  RowBox[{"Dimensions", "[", "TensorData", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Tensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "6"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6376408711401596`*^9, 3.63764090944243*^9}, {
  3.637642223442727*^9, 3.637642224035528*^9}, {3.637642588013631*^9, 
  3.6376425897452335`*^9}, {3.6376427209040656`*^9, 3.6376427701155524`*^9}, {
  3.6376428653375206`*^9, 3.637642901132984*^9}, {3.6376430845609083`*^9, 
  3.6376431307283897`*^9}, {3.6376431863066874`*^9, 3.6376431866342883`*^9}, {
  3.6376436659501348`*^9, 3.637643671285344*^9}, {3.638016044529835*^9, 
  3.6380160579776044`*^9}, {3.638022352874652*^9, 3.638022357140896*^9}, {
  3.638026101989089*^9, 3.6380261058433094`*^9}, {3.6380295187905188`*^9, 
  3.638029591439674*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9", ",", "9", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6386947448877144`*^9, 3.6387265492276173`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]max", " ", "=", " ", 
   RowBox[{"Pi", "/", "2."}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E0", " ", "=", " ", "2."}], ";"}]}], "Input",
 CellChangeTimes->{{3.638694333140591*^9, 3.638694344949812*^9}, {
  3.6387289687500057`*^9, 3.63872896882701*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"{", 
     RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvectors", "[", 
        RowBox[{"Tensor", "[", 
         RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"dim", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"dim", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"dim", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{"Association", "[", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<tensor\>\"", "->", 
              RowBox[{"Tensor", "[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<direction\>\"", "->", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
              RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "1"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kk", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", "2"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<forward\>\"", "->", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<backward\>\"", "->", 
              RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
      "]"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"A", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "}"}], "\[Rule]", 
     RowBox[{"Association", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<tensor\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<direction\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<forward\>\"", "->", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<backward\>\"", "->", 
         RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQrcS60dZJ5rXj90gpOxD9aHdeKojOm62XAaI/bTBm
cAbSUSs8wLTG17ININrhPPcmEG1rL7IdRDecWrgLROd3h/0D0Xo7f/O5AGkb
IxZnEL1P+okbiN5iFBAKolfxhEWC6AXL5yWC6CkhQmkg2ufytywQLa6wJgdE
u8TPKQHLP8uuBNHmm6bUgujamo4GsLnz/NpAtP2yknYQzRJ7oRtEn+s73gum
y97tBNHaUSa7QLTM8lMHQPTEWYqHQLSpxspCNyB9bO4hMP3vv0oFiC6bubIR
RLOEZnWA6LSA/j4QDQCwt4UE
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        ">", "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"B", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        "<=", "0"}], "  ", ")"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eint", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"COS\[Alpha]", " ", "=", " ", 
      RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"COS\[Alpha]", ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{
                 RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
                 "]"}], "]"}], "[", "\"\<position\>\"", "]"}], "-", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
               "]"}]}], ")"}], ".", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
               "]"}], "]"}], "[", "\"\<direction\>\"", "]"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"COS\[Alpha]", ",", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{
                 RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
                 "]"}], "]"}], "[", "\"\<position\>\"", "]"}], "-", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
               "]"}]}], ")"}], ".", 
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
             "]"}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
        "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"COS\[Alpha]", ",", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{
                 RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", 
                 "]"}], "]"}], "[", "\"\<position\>\"", "]"}], "-", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
               "]"}]}], ")"}], ".", 
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}],
               "]"}], "[", "\"\<direction\>\"", "]"}]}], "]"}]}], "]"}], ";", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"COS\[Alpha]", ",", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", 
                RowBox[{
                 RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", 
                 "]"}], "]"}], "[", "\"\<position\>\"", "]"}], "-", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
               "]"}]}], ")"}], ".", 
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
             "]"}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "+", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["E0", "4"]}], "-", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{"cos\[Alpha]", "-", 
            RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
           RowBox[{"1", "-", 
            RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Associate", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newforward", ",", "newbackward", ",", "oldforward", ",", "oldbackward", 
      ",", "E0", ",", "E1", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newforward", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"F", "[", "spin", "]"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"What", " ", "if", " ", "newforward"}], " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "}"}], "?", " ", "Should"}], " ", "not", " ", "happen", 
        " ", "for", " ", "volume", " ", "spins"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"oldforward", " ", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oldbackward", "=", 
      RowBox[{
       RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ", 
      "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "newforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "]"}], ">", " ", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", "oldforward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "oldbackward"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "==="}], "="}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"newbackward", "=", " ", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{"B", "[", "spin", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"oldforward", " ", "=", 
      RowBox[{
       RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"oldbackward", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], " ", 
      "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", "]"}], 
      " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", "  ", 
       RowBox[{"Eint", "[", "newbackward", "]"}], " ", "+", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"Eint", "[", "oldforward", "]"}], " ", "+", " ", 
       RowBox[{"Eint", "[", "oldbackward", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "]"}], ">", " ", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldforward", "]"}], "[", "\"\<backward\>\"", 
          "]"}], " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "oldbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "spin"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", "oldbackward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "newbackward", "]"}], "[", "\"\<forward\>\"", 
          "]"}], " ", "=", " ", "oldforward"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Energy", " ", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "n"}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "\[LessEqual]", "100"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Energy", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"Energy", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Eint", "[", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"dim", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "2"}], ",", 
           RowBox[{"j", "<", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "2"}], ",", 
             RowBox[{"k", "<", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Associate", "[", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6387265850926685`*^9, 3.6387266182545652`*^9}, {
  3.6387266547656536`*^9, 3.638726730015958*^9}, {3.638726767279089*^9, 
  3.6387268341269126`*^9}, {3.638728996310582*^9, 3.638728998703719*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Energy", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638726742098649*^9, 3.6387267497470865`*^9}, {
  3.638726873531166*^9, 3.6387269171386604`*^9}, {3.638726952643691*^9, 
  3.6387269529897113`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1kglQlGUYx7cFEUJNYkeYoENgdlAkSc7l/IOcyy7sLnsJityn3IirES6B
Bakgx7hJIQwjzigyIDRySLBsjaIVlo42BSE5UKZAiAOl2RDV+3wz33zz+/7v
/zne59malCdL5XI4nJS199/v/89iwH+fsdNgP1C8mtc2s3qSsSk2hWR0CUKr
GG+Gfc3Pn255pZIxD05Z8kkvTTlja6zPei8m3lHL2BbaDtm0RW4Z47fgOCGc
9/F7l7EdvG5zI3Z1aBg74KFl0qxVJDEfVuLp18PHShg7YrX++of1c8TbMVf2
V93WEeIduDl6KLbx2UHGb2OptL3u2tekuyDhNU3y5RPFjN+BTrJQ0raNeBf+
/qFGVzZbxNgVxVPLRl9OUzw31Bc47wxqJ3bH/HLvnX3nKb4HKp/HtaZ+S7on
QmebWn83pnheSFnvdXi8rJCxANysOD+RLeX3RknGpNlIH+k+SE+MP8ifyGfs
C9vFyQ9chgsY+6FFkKTmuhL7Y+ioUern2cQBuJPQZd94nxh40TY4/XSYxdMC
gkEzs04L0gMh9Unp3vGEsTYQSYcq7IdklD8IvKoj9zYayB+ExXnbuO9ukX83
pvXHN6bZsfq1u/Gm9eO97aXUfzBcrKNk0WdJDwYvfqAnOYn6DcF1I/6mG1Ok
h6B7lPPA7CbFD0XLleZsQzflDwXviwjoX+QxPQw//ebgrBnJZXoYFq+pG5RV
pIcjI+58wksLOUwPR0Otu9fcRXaeE4EEac6c6i7pEfC3XTHvLzjAdCE4NqZ9
aZ2kC1GbGjvg5MyYE4ng4UulmgfZTI/ErCgzTJzJmCOCcDbQ28OG1aMVYd3V
9DFZH+UXI/LyN9W+QtLFkJiq/UsX6f6j0Hq76xfTdJpPFNoq4oRBC6RH432O
XyZ3iPzR6DeqUIRsofuTILa6fC//M3YeElzpOmXy6xsUb40Vuhv3LzBdL0F9
5Ccfr56l+5NiXmVpcyaC/FJcqt2wc4X2RyuFqNnCRBPLWC9FU894mq6f6pPh
6USRofwe6xcyGFdaHc4YpXnJMOPqv1RrR/lleLa9eLioleqPQQtvqbBVzupB
DPJrooqf9NI+xMBSvaG/+iL513SrsuijQrpfOR75Hhf5LFN+OUq+T0VnBfnl
OObhNq5sZPunlyNz5lbhki/tpwIDfJ3oz32MocB+Q6/1uQbqX4GrisfpAc3k
VyDfYZ1Toif5laiBuGF1GzsPJUye76870kH5lcj/KOOu+lWqX4mZRwZdMpfq
V2FQsOekG80XKvBHeVNpAvKrkOh52vycO/lVMG6Q6H+0pPmp8TC0SWzoofmp
ccD8wqnSEfKrEWv8latJNPnVeLlAecbKiPx7kJu14m33Rw7+AfwvsTk=
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 100.}, {0, 1458.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6387267505311313`*^9, {3.6387268167339177`*^9, 3.6387268254194145`*^9}, {
   3.6387268667777805`*^9, 3.6387269061760335`*^9}, 3.6387269532527266`*^9, 
   3.6387290348557873`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Fiber", "[", 
   RowBox[{"seed_", ",", "str_", ",", "fiber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newfiber", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"str", " ", "\[Equal]", " ", "\"\<forward\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"seed", " ", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "fiber", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newfiber", " ", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"fiber", ",", 
            RowBox[{
             RowBox[{"A", "[", "seed", "]"}], "[", "\"\<position\>\"", 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fiber", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "seed", "]"}], "[", "\"\<forward\>\"", "]"}], 
           ",", "\"\<forward\>\"", ",", "newfiber"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"seed", " ", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "fiber", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newfiber", " ", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"fiber", ",", 
            RowBox[{
             RowBox[{"A", "[", "seed", "]"}], "[", "\"\<position\>\"", 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Fiber", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "seed", "]"}], "[", "\"\<backward\>\"", "]"}], 
           ",", "\"\<backward\>\"", ",", "newfiber"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6387270910996103`*^9, 3.6387271703461432`*^9}, {
  3.6387272069252357`*^9, 3.6387273348025494`*^9}, {3.6387273990692253`*^9, 
  3.638727485409164*^9}, {3.6387275658067627`*^9, 3.638727608037178*^9}, {
  3.638727642596154*^9, 3.638727750756341*^9}, {3.6387278533812103`*^9, 
  3.638727892390442*^9}, {3.6387279694388485`*^9, 3.6387280068389883`*^9}, {
  3.6387281303680534`*^9, 3.6387281577906218`*^9}, {3.6387283358228045`*^9, 
  3.638728391405984*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Surface", " ", "=", " ", 
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.638727753310487*^9, 3.638727762996041*^9}, {
  3.638727897652743*^9, 3.6387279005149064`*^9}, {3.6387279313726716`*^9, 
  3.638727940020166*^9}, {3.6387280968751373`*^9, 3.6387280970441475`*^9}, {
  3.638728176932717*^9, 3.6387281772437344`*^9}, {3.638728405420786*^9, 
  3.6387285100217686`*^9}, {3.6387285478929343`*^9, 3.638728553325245*^9}, {
  3.638728596635722*^9, 3.638728635830964*^9}, {3.6387286686388407`*^9, 
  3.6387287938380013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Fibers", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Fiber", "[", 
         RowBox[{"surfacevoxel", ",", "\"\<forward\>\"", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"surfacevoxel", ",", "Surface"}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Fiber", "[", 
         RowBox[{"surfacevoxel", ",", "\"\<backward\>\"", ",", 
          RowBox[{"{", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"surfacevoxel", ",", "Surface"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LongFibers", "=", 
    RowBox[{"Select", "[", 
     RowBox[{"Fibers", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "#", "]"}], ">", "5"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Thickness", "\[Rule]", "0.005"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"Fibers", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "Fibers", "]"}]}], "}"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6387288041645927`*^9, 3.63872884888315*^9}, {
  3.638729088029828*^9, 3.638729121253729*^9}, {3.638729185060378*^9, 
  3.6387292052775345`*^9}, {3.638729251953204*^9, 3.638729357141221*^9}, {
  3.638729448902469*^9, 3.6387294889267583`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {Thickness[0.005], Line3DBox[{{1, 1, 1}}], Line3DBox[{{1, 1, 2}}], 
   Line3DBox[{{1, 1, 3}}], Line3DBox[{{1, 1, 4}}], Line3DBox[{{1, 1, 5}}], 
   Line3DBox[{{1, 1, 6}}], Line3DBox[{{1, 1, 7}}], Line3DBox[{{1, 1, 8}}], 
   Line3DBox[{{1, 1, 9}}], Line3DBox[{{1, 2, 1}}], Line3DBox[{{1, 2, 2}}], 
   Line3DBox[{{1, 2, 3}}], Line3DBox[{{1, 2, 4}}], Line3DBox[{{1, 2, 5}}], 
   Line3DBox[{{1, 2, 6}}], Line3DBox[{{1, 2, 7}}], Line3DBox[{{1, 2, 8}}], 
   Line3DBox[{{1, 2, 9}}], Line3DBox[{{1, 3, 1}}], Line3DBox[{{1, 3, 2}}], 
   Line3DBox[{{1, 3, 3}}], Line3DBox[{{1, 3, 4}}], Line3DBox[{{1, 3, 5}}], 
   Line3DBox[{{1, 3, 6}}], Line3DBox[{{1, 3, 7}}], 
   Line3DBox[{{1, 3, 8}, {2, 2, 7}, {2, 1, 7}}], 
   Line3DBox[{{1, 3, 9}, {2, 2, 8}, {3, 1, 7}}], Line3DBox[{{1, 4, 1}}], 
   Line3DBox[{{1, 4, 2}, {2, 3, 3}, {2, 2, 4}, {2, 1, 5}}], 
   Line3DBox[{{1, 4, 3}}], Line3DBox[{{1, 4, 4}, {2, 3, 4}}], 
   Line3DBox[{{1, 4, 5}}], Line3DBox[{{1, 4, 6}}], 
   Line3DBox[{{1, 4, 7}, {2, 3, 6}, {3, 2, 5}, {3, 1, 6}}], 
   Line3DBox[{{1, 4, 8}}], Line3DBox[{{1, 4, 9}, {2, 3, 8}}], 
   Line3DBox[{{1, 5, 1}}], Line3DBox[{{1, 5, 2}}], Line3DBox[{{1, 5, 3}}], 
   Line3DBox[{{1, 5, 4}}], Line3DBox[{{1, 5, 5}}], 
   Line3DBox[{{1, 5, 6}, {2, 4, 5}, {2, 5, 5}}], 
   Line3DBox[{{1, 5, 7}, {2, 4, 6}}], 
   Line3DBox[{{1, 5, 8}, {2, 4, 7}, {3, 3, 6}, {4, 2, 5}, {4, 1, 6}}], 
   Line3DBox[{{1, 5, 9}, {2, 4, 8}}], Line3DBox[{{1, 6, 1}}], 
   Line3DBox[{{1, 6, 2}}], Line3DBox[{{1, 6, 3}}], 
   Line3DBox[{{1, 6, 4}, {2, 5, 4}, {2, 4, 3}}], Line3DBox[{{1, 6, 5}}], 
   Line3DBox[{{1, 6, 6}, {2, 7, 6}, {3, 8, 5}, {4, 8, 5}}], 
   Line3DBox[{{1, 6, 7}, {2, 5, 6}, {3, 4, 5}, {4, 3, 6}, {5, 2, 7}, {6, 1, 
    8}}], Line3DBox[{{1, 6, 8}, {2, 7, 7}, {3, 8, 6}, {4, 9, 6}}], 
   Line3DBox[{{1, 6, 9}, {2, 6, 8}}], Line3DBox[{{1, 7, 1}}], 
   Line3DBox[{{1, 7, 2}}], Line3DBox[{{1, 7, 3}}], Line3DBox[{{1, 7, 4}}], 
   Line3DBox[{{1, 7, 5}}], Line3DBox[{{1, 7, 6}}], 
   Line3DBox[{{1, 7, 7}, {2, 8, 6}, {3, 9, 5}}], 
   Line3DBox[{{1, 7, 8}, {2, 6, 7}, {3, 5, 7}}], 
   Line3DBox[{{1, 7, 9}, {2, 8, 8}, {3, 9, 7}}], Line3DBox[{{1, 8, 1}}], 
   Line3DBox[{{1, 8, 2}, {2, 7, 3}, {1, 6, 2}}], 
   Line3DBox[{{1, 8, 3}, {2, 7, 4}}], Line3DBox[{{1, 8, 4}}], 
   Line3DBox[{{1, 8, 5}, {2, 8, 5}, {3, 9, 4}}], Line3DBox[{{1, 8, 6}}], 
   Line3DBox[{{1, 8, 7}, {2, 8, 7}, {3, 9, 6}}], Line3DBox[{{1, 8, 8}}], 
   Line3DBox[{{1, 8, 9}}], Line3DBox[{{1, 9, 1}}], Line3DBox[{{1, 9, 2}}], 
   Line3DBox[{{1, 9, 3}}], Line3DBox[{{1, 9, 4}}], Line3DBox[{{1, 9, 5}}], 
   Line3DBox[{{1, 9, 6}}], Line3DBox[{{1, 9, 7}}], Line3DBox[{{1, 9, 8}}], 
   Line3DBox[{{1, 9, 9}}], Line3DBox[{{2, 1, 1}}], 
   Line3DBox[{{2, 1, 2}, {2, 2, 2}, {1, 3, 3}}], Line3DBox[{{2, 1, 3}}], 
   Line3DBox[{{2, 1, 4}}], Line3DBox[{{2, 1, 5}}], Line3DBox[{{2, 1, 6}}], 
   Line3DBox[{{2, 1, 7}}], Line3DBox[{{2, 1, 8}}], Line3DBox[{{2, 1, 9}}], 
   Line3DBox[{{2, 2, 1}, {2, 3, 2}, {3, 4, 1}, {4, 3, 2}, {3, 2, 3}, {4, 1, 
    4}}], Line3DBox[{{2, 2, 9}}], Line3DBox[{{2, 3, 1}}], 
   Line3DBox[{{2, 3, 9}, {3, 2, 8}, {3, 1, 8}}], Line3DBox[{{2, 4, 1}}], 
   Line3DBox[{{2, 4, 9}}], Line3DBox[{{2, 5, 1}, {2, 4, 2}, {1, 3, 2}}], 
   Line3DBox[{{2, 5, 9}, {3, 4, 8}, {3, 3, 7}, {3, 2, 6}}], 
   Line3DBox[{{2, 6, 1}}], 
   Line3DBox[{{2, 6, 9}, {3, 7, 8}, {4, 8, 7}, {5, 9, 7}, {6, 8, 8}, {7, 7, 
    8}, {8, 6, 8}, {8, 5, 9}}], Line3DBox[{{2, 7, 1}}], 
   Line3DBox[{{2, 7, 9}, {3, 8, 8}, {4, 9, 8}}], 
   Line3DBox[{{2, 8, 1}, {2, 7, 2}, {2, 6, 3}, {2, 5, 2}, {1, 4, 2}, {2, 3, 
    3}, {2, 2, 4}, {2, 1, 5}}], Line3DBox[{{2, 8, 9}}], 
   Line3DBox[{{2, 9, 1}, {2, 8, 2}}], Line3DBox[{{2, 9, 2}}], 
   Line3DBox[{{2, 9, 3}}], Line3DBox[{{2, 9, 4}}], Line3DBox[{{2, 9, 5}}], 
   Line3DBox[{{2, 9, 6}}], Line3DBox[{{2, 9, 7}}], Line3DBox[{{2, 9, 8}}], 
   Line3DBox[{{2, 9, 9}}], Line3DBox[{{3, 1, 1}}], Line3DBox[{{3, 1, 2}}], 
   Line3DBox[{{3, 1, 3}}], Line3DBox[{{3, 1, 4}}], Line3DBox[{{3, 1, 5}}], 
   Line3DBox[{{3, 1, 6}}], Line3DBox[{{3, 1, 7}}], Line3DBox[{{3, 1, 8}}], 
   Line3DBox[{{3, 1, 9}}], Line3DBox[{{3, 2, 1}}], Line3DBox[{{3, 2, 9}}], 
   Line3DBox[{{3, 3, 1}, {4, 2, 2}, {3, 1, 3}}], Line3DBox[{{3, 3, 9}}], 
   Line3DBox[{{3, 4, 1}, {4, 3, 2}, {3, 2, 3}, {4, 1, 4}}], 
   Line3DBox[{{3, 4, 9}}], Line3DBox[{{3, 5, 1}}], Line3DBox[{{3, 5, 9}}], 
   Line3DBox[{{3, 6, 1}, {3, 5, 2}, {4, 4, 3}, {4, 4, 4}, {5, 3, 5}, {6, 2, 
    6}, {7, 1, 7}}], Line3DBox[{{3, 6, 9}, {4, 5, 8}, {5, 4, 8}, {6, 3, 9}}], 
   Line3DBox[{{3, 7, 1}, {2, 6, 2}, {1, 5, 3}}], 
   Line3DBox[{{3, 7, 9}, {4, 6, 8}, {5, 5, 7}, {6, 4, 8}, {7, 3, 9}}], 
   Line3DBox[{{3, 8, 1}}], Line3DBox[{{3, 8, 9}}], 
   Line3DBox[{{3, 9, 1}, {4, 8, 2}, {3, 8, 3}, {3, 7, 4}, {2, 6, 5}, {1, 7, 
    5}}], Line3DBox[{{3, 9, 2}, {2, 8, 3}, {1, 7, 3}}], 
   Line3DBox[{{3, 9, 3}, {2, 8, 4}, {1, 8, 5}, {2, 8, 5}, {3, 9, 4}}], 
   Line3DBox[{{3, 9, 4}}], Line3DBox[{{3, 9, 5}}], Line3DBox[{{3, 9, 6}}], 
   Line3DBox[{{3, 9, 7}}], Line3DBox[{{3, 9, 8}}], Line3DBox[{{3, 9, 9}}], 
   Line3DBox[{{4, 1, 1}}], Line3DBox[{{4, 1, 2}}], Line3DBox[{{4, 1, 3}}], 
   Line3DBox[{{4, 1, 4}}], Line3DBox[{{4, 1, 5}}], Line3DBox[{{4, 1, 6}}], 
   Line3DBox[{{4, 1, 7}}], Line3DBox[{{4, 1, 8}}], Line3DBox[{{4, 1, 9}}], 
   Line3DBox[{{4, 2, 1}}], Line3DBox[{{4, 2, 9}}], 
   Line3DBox[{{4, 3, 1}, {3, 2, 2}, {4, 1, 3}}], Line3DBox[{{4, 3, 9}}], 
   Line3DBox[{{4, 4, 1}, {3, 3, 2}, {2, 2, 3}, {2, 1, 3}}], 
   Line3DBox[{{4, 4, 9}, {5, 3, 8}, {6, 2, 8}, {6, 1, 9}}], 
   Line3DBox[{{4, 5, 1}, {3, 4, 2}}], 
   Line3DBox[{{4, 5, 9}, {4, 4, 8}, {5, 3, 7}, {4, 4, 7}, {3, 5, 8}}], 
   Line3DBox[{{4, 6, 1}, {4, 6, 2}, {5, 5, 3}, {5, 4, 4}, {6, 3, 5}, {7, 2, 
    6}, {8, 1, 7}}], Line3DBox[{{4, 6, 9}, {5, 5, 8}, {6, 4, 9}}], 
   Line3DBox[{{4, 7, 1}, {3, 6, 2}, {2, 5, 3}, {3, 4, 4}, {3, 3, 5}, {4, 2, 
    6}, {5, 1, 7}, {4, 2, 7}, {3, 3, 8}, {4, 2, 8}, {5, 1, 8}}], 
   Line3DBox[{{4, 7, 9}}], 
   Line3DBox[{{4, 8, 1}, {3, 7, 2}, {3, 6, 3}, {4, 5, 4}, {5, 4, 5}, {6, 3, 
    6}, {7, 2, 7}, {8, 1, 8}}], 
   Line3DBox[{{4, 8, 9}, {5, 7, 8}, {6, 8, 7}, {7, 9, 8}}], 
   Line3DBox[{{4, 9, 1}, {3, 8, 2}, {3, 7, 3}, {2, 6, 4}, {3, 5, 5}, {4, 5, 
    6}, {5, 4, 7}, {6, 3, 8}, {6, 2, 9}}], 
   Line3DBox[{{4, 9, 2}, {5, 8, 3}, {6, 9, 4}, {7, 8, 5}, {8, 8, 6}, {9, 9, 
    7}}], Line3DBox[{{4, 9, 3}, {4, 8, 4}, {5, 7, 5}, {6, 6, 5}}], 
   Line3DBox[{{4, 9, 4}, {5, 8, 5}}], Line3DBox[{{4, 9, 5}}], 
   Line3DBox[{{4, 9, 6}}], 
   Line3DBox[{{4, 9, 7}, {3, 8, 7}, {2, 7, 8}, {3, 8, 9}}], 
   Line3DBox[{{4, 9, 8}}], Line3DBox[{{4, 9, 9}}], Line3DBox[{{5, 1, 1}}], 
   Line3DBox[{{5, 1, 2}}], Line3DBox[{{5, 1, 3}}], Line3DBox[{{5, 1, 4}}], 
   Line3DBox[{{5, 1, 5}}], Line3DBox[{{5, 1, 6}}], 
   Line3DBox[{{5, 1, 7}, {4, 2, 7}, {3, 3, 8}, {4, 2, 8}, {5, 1, 8}}], 
   Line3DBox[{{5, 1, 8}}], Line3DBox[{{5, 1, 9}}], Line3DBox[{{5, 2, 1}}], 
   Line3DBox[{{5, 2, 9}}], Line3DBox[{{5, 3, 1}, {5, 2, 2}, {6, 1, 3}}], 
   Line3DBox[{{5, 3, 9}}], Line3DBox[{{5, 4, 1}}], Line3DBox[{{5, 4, 9}}], 
   Line3DBox[{{5, 5, 1}, {6, 4, 2}, {5, 3, 3}}], 
   Line3DBox[{{5, 5, 9}, {5, 6, 8}, {6, 7, 7}}], 
   Line3DBox[{{5, 6, 1}, {4, 5, 2}, {3, 4, 3}, {3, 3, 3}, {3, 2, 4}, {3, 1, 
    5}}], Line3DBox[{{5, 6, 9}}], 
   Line3DBox[{{5, 7, 1}, {6, 6, 2}, {6, 5, 3}, {7, 4, 4}, {8, 3, 5}, {9, 2, 
    6}}], Line3DBox[{{5, 7, 9}}], 
   Line3DBox[{{5, 8, 1}, {4, 7, 2}, {4, 6, 3}, {3, 5, 4}, {4, 4, 5}, {5, 3, 
    6}, {6, 2, 7}, {7, 1, 8}}], 
   Line3DBox[{{5, 8, 9}, {6, 7, 8}, {7, 7, 7}, {6, 6, 8}}], 
   Line3DBox[{{5, 9, 1}, {6, 8, 2}, {5, 7, 2}, {6, 6, 3}, {7, 7, 4}, {8, 6, 
    5}, {9, 5, 5}}], 
   Line3DBox[{{5, 9, 2}, {4, 8, 3}, {5, 8, 4}, {6, 8, 5}, {7, 7, 6}, {8, 6, 
    6}, {9, 5, 7}}], 
   Line3DBox[{{5, 9, 3}, {6, 8, 4}, {7, 7, 5}, {8, 7, 6}, {9, 8, 7}}], 
   Line3DBox[{{5, 9, 4}}], Line3DBox[{{5, 9, 5}, {6, 8, 6}, {7, 9, 7}}], 
   Line3DBox[{{5, 9, 6}}], 
   Line3DBox[{{5, 9, 7}, {6, 8, 8}, {7, 7, 8}, {8, 6, 8}, {8, 5, 9}}], 
   Line3DBox[{{5, 9, 8}}], Line3DBox[{{5, 9, 9}}], Line3DBox[{{6, 1, 1}}], 
   Line3DBox[{{6, 1, 2}}], Line3DBox[{{6, 1, 3}}], Line3DBox[{{6, 1, 4}}], 
   Line3DBox[{{6, 1, 5}}], Line3DBox[{{6, 1, 6}}], Line3DBox[{{6, 1, 7}}], 
   Line3DBox[{{6, 1, 8}}], Line3DBox[{{6, 1, 9}}], 
   Line3DBox[{{6, 2, 1}, {5, 3, 2}, {4, 2, 3}, {3, 1, 4}}], 
   Line3DBox[{{6, 2, 9}}], Line3DBox[{{6, 3, 1}, {6, 2, 2}, {5, 1, 3}}], 
   Line3DBox[{{6, 3, 9}}], 
   Line3DBox[{{6, 4, 1}, {7, 5, 2}, {7, 4, 3}, {6, 3, 4}, {6, 2, 5}, {5, 1, 
    6}}], Line3DBox[{{6, 4, 9}}], 
   Line3DBox[{{6, 5, 1}, {5, 4, 2}, {6, 4, 3}, {5, 3, 4}}], 
   Line3DBox[{{6, 5, 9}}], Line3DBox[{{6, 6, 1}, {5, 5, 2}}], 
   Line3DBox[{{6, 6, 9}, {7, 5, 8}, {7, 4, 9}}], 
   Line3DBox[{{6, 7, 1}, {5, 6, 2}, {4, 5, 3}}], 
   Line3DBox[{{6, 7, 9}, {7, 6, 8}}], 
   Line3DBox[{{6, 8, 1}, {6, 7, 2}, {7, 6, 3}, {8, 5, 4}, {9, 4, 5}}], 
   Line3DBox[{{6, 8, 9}}], 
   Line3DBox[{{6, 9, 1}, {5, 8, 2}, {5, 7, 3}, {4, 6, 4}, {3, 6, 5}, {4, 7, 
    4}, {3, 7, 5}}], 
   Line3DBox[{{6, 9, 2}, {6, 8, 3}, {6, 7, 4}, {7, 6, 5}, {8, 5, 6}}], 
   Line3DBox[{{6, 9, 3}, {7, 8, 4}, {8, 7, 5}, {9, 7, 6}}], 
   Line3DBox[{{6, 9, 4}, {7, 8, 5}, {8, 8, 6}, {9, 9, 7}}], 
   Line3DBox[{{6, 9, 5}, {7, 8, 6}, {8, 7, 7}, {9, 6, 7}}], 
   Line3DBox[{{6, 9, 6}}], 
   Line3DBox[{{6, 9, 7}, {7, 8, 8}, {8, 9, 8}, {7, 8, 7}, {6, 9, 6}}], 
   Line3DBox[{{6, 9, 8}, {5, 8, 7}, {4, 7, 8}, {5, 8, 8}, {6, 9, 7}, {7, 8, 
    8}, {8, 9, 8}, {7, 8, 7}, {6, 9, 6}}], Line3DBox[{{6, 9, 9}}], 
   Line3DBox[{{7, 1, 1}}], Line3DBox[{{7, 1, 2}}], Line3DBox[{{7, 1, 3}}], 
   Line3DBox[{{7, 1, 4}}], Line3DBox[{{7, 1, 5}}], Line3DBox[{{7, 1, 6}}], 
   Line3DBox[{{7, 1, 7}}], Line3DBox[{{7, 1, 8}}], Line3DBox[{{7, 1, 9}}], 
   Line3DBox[{{7, 2, 1}}], Line3DBox[{{7, 2, 9}}], Line3DBox[{{7, 3, 1}}], 
   Line3DBox[{{7, 3, 9}}], 
   Line3DBox[{{7, 4, 1}, {6, 3, 2}, {5, 2, 3}, {6, 1, 4}}], 
   Line3DBox[{{7, 4, 9}}], Line3DBox[{{7, 5, 1}}], Line3DBox[{{7, 5, 9}}], 
   Line3DBox[{{7, 6, 1}}], Line3DBox[{{7, 6, 9}, {6, 5, 8}, {7, 4, 8}}], 
   Line3DBox[{{7, 7, 1}, {7, 6, 2}, {7, 5, 3}, {6, 4, 4}, {7, 3, 5}, {8, 2, 
    6}, {9, 3, 7}}], Line3DBox[{{7, 7, 9}}], 
   Line3DBox[{{7, 8, 1}, {7, 7, 2}, {8, 6, 3}}], Line3DBox[{{7, 8, 9}}], 
   Line3DBox[{{7, 9, 1}, {8, 8, 2}, {8, 7, 3}, {9, 6, 4}}], 
   Line3DBox[{{7, 9, 2}, {7, 8, 3}, {8, 7, 4}, {9, 6, 5}}], 
   Line3DBox[{{7, 9, 3}, {8, 8, 4}, {9, 8, 5}}], 
   Line3DBox[{{7, 9, 4}, {8, 8, 5}, {9, 9, 6}}], Line3DBox[{{7, 9, 5}}], 
   Line3DBox[{{7, 9, 6}}], Line3DBox[{{7, 9, 7}}], Line3DBox[{{7, 9, 8}}], 
   Line3DBox[{{7, 9, 9}}], Line3DBox[{{8, 1, 1}}], Line3DBox[{{8, 1, 2}}], 
   Line3DBox[{{8, 1, 3}}], Line3DBox[{{8, 1, 4}}], Line3DBox[{{8, 1, 5}}], 
   Line3DBox[{{8, 1, 6}}], Line3DBox[{{8, 1, 7}}], Line3DBox[{{8, 1, 8}}], 
   Line3DBox[{{8, 1, 9}}], Line3DBox[{{8, 2, 1}, {8, 2, 2}, {8, 1, 3}}], 
   Line3DBox[{{8, 2, 9}}], Line3DBox[{{8, 3, 1}, {7, 2, 2}, {7, 2, 3}}], 
   Line3DBox[{{8, 3, 9}}], 
   Line3DBox[{{8, 4, 1}, {7, 3, 2}, {8, 2, 3}, {8, 1, 4}}], 
   Line3DBox[{{8, 4, 9}}], 
   Line3DBox[{{8, 5, 1}, {7, 4, 2}, {8, 4, 3}, {8, 3, 4}, {9, 2, 5}}], 
   Line3DBox[{{8, 5, 9}}], Line3DBox[{{8, 6, 1}}], Line3DBox[{{8, 6, 9}}], 
   Line3DBox[{{8, 7, 1}}], Line3DBox[{{8, 7, 9}}], 
   Line3DBox[{{8, 8, 1}, {8, 7, 2}}], Line3DBox[{{8, 8, 9}}], 
   Line3DBox[{{8, 9, 1}, {7, 8, 2}, {6, 7, 3}, {6, 6, 4}}], 
   Line3DBox[{{8, 9, 2}, {8, 8, 3}, {9, 7, 4}}], Line3DBox[{{8, 9, 3}}], 
   Line3DBox[{{8, 9, 4}}], Line3DBox[{{8, 9, 5}}], Line3DBox[{{8, 9, 6}}], 
   Line3DBox[{{8, 9, 7}}], Line3DBox[{{8, 9, 8}, {7, 8, 7}, {6, 9, 6}}], 
   Line3DBox[{{8, 9, 9}}], Line3DBox[{{9, 1, 1}}], Line3DBox[{{9, 1, 2}}], 
   Line3DBox[{{9, 1, 3}}], Line3DBox[{{9, 1, 4}}], Line3DBox[{{9, 1, 5}}], 
   Line3DBox[{{9, 1, 6}}], Line3DBox[{{9, 1, 7}}], Line3DBox[{{9, 1, 8}}], 
   Line3DBox[{{9, 1, 9}}], Line3DBox[{{9, 2, 1}}], Line3DBox[{{9, 2, 2}}], 
   Line3DBox[{{9, 2, 3}}], Line3DBox[{{9, 2, 4}}], Line3DBox[{{9, 2, 5}}], 
   Line3DBox[{{9, 2, 6}}], Line3DBox[{{9, 2, 7}}], Line3DBox[{{9, 2, 8}}], 
   Line3DBox[{{9, 2, 9}}], Line3DBox[{{9, 3, 1}}], Line3DBox[{{9, 3, 2}}], 
   Line3DBox[{{9, 3, 3}}], Line3DBox[{{9, 3, 4}}], Line3DBox[{{9, 3, 5}}], 
   Line3DBox[{{9, 3, 6}}], Line3DBox[{{9, 3, 7}}], Line3DBox[{{9, 3, 8}}], 
   Line3DBox[{{9, 3, 9}}], Line3DBox[{{9, 4, 1}, {8, 3, 2}, {9, 2, 3}}], 
   Line3DBox[{{9, 4, 2}}], Line3DBox[{{9, 4, 3}}], Line3DBox[{{9, 4, 4}}], 
   Line3DBox[{{9, 4, 5}}], Line3DBox[{{9, 4, 6}}], Line3DBox[{{9, 4, 7}}], 
   Line3DBox[{{9, 4, 8}}], Line3DBox[{{9, 4, 9}}], 
   Line3DBox[{{9, 5, 1}, {8, 4, 2}, {7, 3, 3}, {8, 2, 4}, {9, 1, 5}}], 
   Line3DBox[{{9, 5, 2}}], Line3DBox[{{9, 5, 3}, {8, 4, 4}, {9, 3, 5}}], 
   Line3DBox[{{9, 5, 4}}], Line3DBox[{{9, 5, 5}}], Line3DBox[{{9, 5, 6}}], 
   Line3DBox[{{9, 5, 7}}], Line3DBox[{{9, 5, 8}}], Line3DBox[{{9, 5, 9}}], 
   Line3DBox[{{9, 6, 1}, {8, 5, 2}}], 
   Line3DBox[{{9, 6, 2}, {8, 5, 3}, {9, 4, 4}}], Line3DBox[{{9, 6, 3}}], 
   Line3DBox[{{9, 6, 4}}], Line3DBox[{{9, 6, 5}}], Line3DBox[{{9, 6, 6}}], 
   Line3DBox[{{9, 6, 7}}], Line3DBox[{{9, 6, 8}}], Line3DBox[{{9, 6, 9}}], 
   Line3DBox[{{9, 7, 1}, {8, 6, 2}, {9, 5, 3}, {8, 4, 4}, {9, 3, 5}}], 
   Line3DBox[{{9, 7, 2}}], Line3DBox[{{9, 7, 3}}], Line3DBox[{{9, 7, 4}}], 
   Line3DBox[{{9, 7, 5}}], Line3DBox[{{9, 7, 6}}], 
   Line3DBox[{{9, 7, 7}, {8, 7, 8}, {7, 6, 9}, {6, 5, 8}, {7, 4, 8}}], 
   Line3DBox[{{9, 7, 8}, {8, 8, 8}, {7, 7, 9}}], Line3DBox[{{9, 7, 9}}], 
   Line3DBox[{{9, 8, 1}}], Line3DBox[{{9, 8, 2}}], Line3DBox[{{9, 8, 3}}], 
   Line3DBox[{{9, 8, 4}}], Line3DBox[{{9, 8, 5}}], Line3DBox[{{9, 8, 6}}], 
   Line3DBox[{{9, 8, 7}}], Line3DBox[{{9, 8, 8}}], Line3DBox[{{9, 8, 9}}], 
   Line3DBox[{{9, 9, 1}}], Line3DBox[{{9, 9, 2}}], Line3DBox[{{9, 9, 3}}], 
   Line3DBox[{{9, 9, 4}}], Line3DBox[{{9, 9, 5}}], Line3DBox[{{9, 9, 6}}], 
   Line3DBox[{{9, 9, 7}}], Line3DBox[{{9, 9, 8}}], Line3DBox[{{9, 9, 9}}], 
   Line3DBox[{{1, 1, 1}}], Line3DBox[{{1, 1, 2}}], Line3DBox[{{1, 1, 3}}], 
   Line3DBox[{{1, 1, 4}, {2, 2, 5}, {3, 3, 4}}], Line3DBox[{{1, 1, 5}}], 
   Line3DBox[{{1, 1, 6}}], Line3DBox[{{1, 1, 7}, {2, 2, 6}}], 
   Line3DBox[{{1, 1, 8}}], Line3DBox[{{1, 1, 9}}], Line3DBox[{{1, 2, 1}}], 
   Line3DBox[{{1, 2, 2}}], Line3DBox[{{1, 2, 3}}], Line3DBox[{{1, 2, 4}}], 
   Line3DBox[{{1, 2, 5}}], Line3DBox[{{1, 2, 6}}], 
   Line3DBox[{{1, 2, 7}, {2, 3, 7}}], Line3DBox[{{1, 2, 8}}], 
   Line3DBox[{{1, 2, 9}}], Line3DBox[{{1, 3, 1}}], 
   Line3DBox[{{1, 3, 2}, {2, 4, 2}, {2, 5, 1}}], 
   Line3DBox[{{1, 3, 3}, {2, 2, 2}, {2, 1, 2}}], Line3DBox[{{1, 3, 4}}], 
   Line3DBox[{{1, 3, 5}}], Line3DBox[{{1, 3, 6}}], Line3DBox[{{1, 3, 7}}], 
   Line3DBox[{{1, 3, 8}}], Line3DBox[{{1, 3, 9}}], Line3DBox[{{1, 4, 1}}], 
   Line3DBox[{{1, 4, 2}, {2, 5, 2}, {2, 6, 3}, {2, 7, 2}, {2, 8, 1}}], 
   Line3DBox[{{1, 4, 3}}], Line3DBox[{{1, 4, 4}}], Line3DBox[{{1, 4, 5}}], 
   Line3DBox[{{1, 4, 6}}], Line3DBox[{{1, 4, 7}}], Line3DBox[{{1, 4, 8}}], 
   Line3DBox[{{1, 4, 9}}], Line3DBox[{{1, 5, 1}}], Line3DBox[{{1, 5, 2}}], 
   Line3DBox[{{1, 5, 3}, {2, 6, 2}, {3, 7, 1}}], Line3DBox[{{1, 5, 4}}], 
   Line3DBox[{{1, 5, 5}}], Line3DBox[{{1, 5, 6}}], Line3DBox[{{1, 5, 7}}], 
   Line3DBox[{{1, 5, 8}}], Line3DBox[{{1, 5, 9}}], Line3DBox[{{1, 6, 1}}], 
   Line3DBox[{{1, 6, 2}, {2, 7, 3}, {1, 8, 2}}], Line3DBox[{{1, 6, 3}}], 
   Line3DBox[{{1, 6, 4}}], Line3DBox[{{1, 6, 5}}], Line3DBox[{{1, 6, 6}}], 
   Line3DBox[{{1, 6, 7}}], Line3DBox[{{1, 6, 8}}], Line3DBox[{{1, 6, 9}}], 
   Line3DBox[{{1, 7, 1}}], Line3DBox[{{1, 7, 2}}], 
   Line3DBox[{{1, 7, 3}, {2, 8, 3}, {3, 9, 2}}], Line3DBox[{{1, 7, 4}}], 
   Line3DBox[{{1, 7, 5}, {2, 6, 5}, {3, 7, 4}, {3, 8, 3}, {4, 8, 2}, {3, 9, 
    1}}], Line3DBox[{{1, 7, 6}}], Line3DBox[{{1, 7, 7}}], 
   Line3DBox[{{1, 7, 8}}], Line3DBox[{{1, 7, 9}}], Line3DBox[{{1, 8, 1}}], 
   Line3DBox[{{1, 8, 2}}], Line3DBox[{{1, 8, 3}}], Line3DBox[{{1, 8, 4}}], 
   Line3DBox[{{1, 8, 5}, {2, 8, 4}, {3, 9, 3}}], Line3DBox[{{1, 8, 6}}], 
   Line3DBox[{{1, 8, 7}}], Line3DBox[{{1, 8, 8}}], Line3DBox[{{1, 8, 9}}], 
   Line3DBox[{{1, 9, 1}}], Line3DBox[{{1, 9, 2}}], Line3DBox[{{1, 9, 3}}], 
   Line3DBox[{{1, 9, 4}}], Line3DBox[{{1, 9, 5}}], Line3DBox[{{1, 9, 6}}], 
   Line3DBox[{{1, 9, 7}}], Line3DBox[{{1, 9, 8}}], Line3DBox[{{1, 9, 9}}], 
   Line3DBox[{{2, 1, 1}}], Line3DBox[{{2, 1, 2}}], 
   Line3DBox[{{2, 1, 3}, {2, 2, 3}, {3, 3, 2}, {4, 4, 1}}], 
   Line3DBox[{{2, 1, 4}}], 
   Line3DBox[{{2, 1, 5}, {2, 2, 4}, {2, 3, 3}, {1, 4, 2}, {2, 5, 2}, {2, 6, 
    3}, {2, 7, 2}, {2, 8, 1}}], 
   Line3DBox[{{2, 1, 6}, {3, 2, 7}, {4, 3, 8}, {3, 4, 7}}], 
   Line3DBox[{{2, 1, 7}, {2, 2, 7}, {1, 3, 8}}], Line3DBox[{{2, 1, 8}}], 
   Line3DBox[{{2, 1, 9}}], Line3DBox[{{2, 2, 1}}], Line3DBox[{{2, 2, 9}}], 
   Line3DBox[{{2, 3, 1}}], Line3DBox[{{2, 3, 9}}], Line3DBox[{{2, 4, 1}}], 
   Line3DBox[{{2, 4, 9}}], Line3DBox[{{2, 5, 1}}], Line3DBox[{{2, 5, 9}}], 
   Line3DBox[{{2, 6, 1}}], Line3DBox[{{2, 6, 9}}], Line3DBox[{{2, 7, 1}}], 
   Line3DBox[{{2, 7, 9}}], Line3DBox[{{2, 8, 1}}], Line3DBox[{{2, 8, 9}}], 
   Line3DBox[{{2, 9, 1}}], Line3DBox[{{2, 9, 2}}], Line3DBox[{{2, 9, 3}}], 
   Line3DBox[{{2, 9, 4}}], Line3DBox[{{2, 9, 5}}], Line3DBox[{{2, 9, 6}}], 
   Line3DBox[{{2, 9, 7}}], Line3DBox[{{2, 9, 8}}], Line3DBox[{{2, 9, 9}}], 
   Line3DBox[{{3, 1, 1}}], Line3DBox[{{3, 1, 2}}], 
   Line3DBox[{{3, 1, 3}, {4, 2, 2}, {3, 3, 1}}], 
   Line3DBox[{{3, 1, 4}, {4, 2, 3}, {5, 3, 2}, {6, 2, 1}}], 
   Line3DBox[{{3, 1, 5}, {3, 2, 4}, {3, 3, 3}, {3, 4, 3}, {4, 5, 2}, {5, 6, 
    1}}], Line3DBox[{{3, 1, 6}, {3, 2, 5}, {2, 3, 6}, {1, 4, 7}}], 
   Line3DBox[{{3, 1, 7}, {2, 2, 8}, {1, 3, 9}}], 
   Line3DBox[{{3, 1, 8}, {3, 2, 8}, {2, 3, 9}}], Line3DBox[{{3, 1, 9}}], 
   Line3DBox[{{3, 2, 1}}], Line3DBox[{{3, 2, 9}}], Line3DBox[{{3, 3, 1}}], 
   Line3DBox[{{3, 3, 9}}], Line3DBox[{{3, 4, 1}, {2, 3, 2}, {2, 2, 1}}], 
   Line3DBox[{{3, 4, 9}, {2, 5, 8}}], Line3DBox[{{3, 5, 1}}], 
   Line3DBox[{{3, 5, 9}}], Line3DBox[{{3, 6, 1}}], Line3DBox[{{3, 6, 9}}], 
   Line3DBox[{{3, 7, 1}}], Line3DBox[{{3, 7, 9}}], Line3DBox[{{3, 8, 1}}], 
   Line3DBox[{{3, 8, 9}, {2, 7, 8}, {3, 8, 7}, {4, 9, 7}}], 
   Line3DBox[{{3, 9, 1}}], Line3DBox[{{3, 9, 2}}], Line3DBox[{{3, 9, 3}}], 
   Line3DBox[{{3, 9, 4}, {2, 8, 5}, {1, 8, 5}, {2, 8, 4}, {3, 9, 3}}], 
   Line3DBox[{{3, 9, 5}, {2, 8, 6}, {1, 7, 7}}], 
   Line3DBox[{{3, 9, 6}, {2, 8, 7}, {1, 8, 7}}], 
   Line3DBox[{{3, 9, 7}, {2, 8, 8}, {1, 7, 9}}], Line3DBox[{{3, 9, 8}}], 
   Line3DBox[{{3, 9, 9}}], Line3DBox[{{4, 1, 1}}], Line3DBox[{{4, 1, 2}}], 
   Line3DBox[{{4, 1, 3}, {3, 2, 2}, {4, 3, 1}}], 
   Line3DBox[{{4, 1, 4}, {3, 2, 3}, {4, 3, 2}, {3, 4, 1}, {2, 3, 2}, {2, 2, 
    1}}], Line3DBox[{{4, 1, 5}, {5, 2, 4}}], 
   Line3DBox[{{4, 1, 6}, {4, 2, 5}, {3, 3, 6}, {2, 4, 7}, {1, 5, 8}}], 
   Line3DBox[{{4, 1, 7}}], Line3DBox[{{4, 1, 8}}], Line3DBox[{{4, 1, 9}}], 
   Line3DBox[{{4, 2, 1}}], Line3DBox[{{4, 2, 9}}], Line3DBox[{{4, 3, 1}}], 
   Line3DBox[{{4, 3, 9}}], Line3DBox[{{4, 4, 1}}], Line3DBox[{{4, 4, 9}}], 
   Line3DBox[{{4, 5, 1}}], Line3DBox[{{4, 5, 9}}], Line3DBox[{{4, 6, 1}}], 
   Line3DBox[{{4, 6, 9}}], Line3DBox[{{4, 7, 1}}], Line3DBox[{{4, 7, 9}}], 
   Line3DBox[{{4, 8, 1}}], Line3DBox[{{4, 8, 9}}], Line3DBox[{{4, 9, 1}}], 
   Line3DBox[{{4, 9, 2}}], Line3DBox[{{4, 9, 3}}], Line3DBox[{{4, 9, 4}}], 
   Line3DBox[{{4, 9, 5}}], 
   Line3DBox[{{4, 9, 6}, {3, 8, 6}, {2, 7, 7}, {1, 6, 8}}], 
   Line3DBox[{{4, 9, 7}}], Line3DBox[{{4, 9, 8}, {3, 8, 8}, {2, 7, 9}}], 
   Line3DBox[{{4, 9, 9}}], Line3DBox[{{5, 1, 1}}], Line3DBox[{{5, 1, 2}}], 
   Line3DBox[{{5, 1, 3}, {6, 2, 2}, {6, 3, 1}}], 
   Line3DBox[{{5, 1, 4}, {6, 2, 3}}], 
   Line3DBox[{{5, 1, 5}, {4, 2, 4}, {4, 3, 3}, {4, 4, 2}}], 
   Line3DBox[{{5, 1, 6}, {6, 2, 5}, {6, 3, 4}, {7, 4, 3}, {7, 5, 2}, {6, 4, 
    1}}], Line3DBox[{{5, 1, 7}, {4, 2, 6}, {3, 3, 5}, {3, 4, 4}, {2, 5, 3}, {
    3, 6, 2}, {4, 7, 1}}], 
   Line3DBox[{{5, 1, 8}, {4, 2, 8}, {3, 3, 8}, {4, 2, 7}, {5, 1, 7}, {4, 2, 
    6}, {3, 3, 5}, {3, 4, 4}, {2, 5, 3}, {3, 6, 2}, {4, 7, 1}}], 
   Line3DBox[{{5, 1, 9}}], Line3DBox[{{5, 2, 1}}], Line3DBox[{{5, 2, 9}}], 
   Line3DBox[{{5, 3, 1}}], Line3DBox[{{5, 3, 9}}], Line3DBox[{{5, 4, 1}}], 
   Line3DBox[{{5, 4, 9}}], Line3DBox[{{5, 5, 1}}], Line3DBox[{{5, 5, 9}}], 
   Line3DBox[{{5, 6, 1}}], Line3DBox[{{5, 6, 9}}], Line3DBox[{{5, 7, 1}}], 
   Line3DBox[{{5, 7, 9}}], Line3DBox[{{5, 8, 1}}], Line3DBox[{{5, 8, 9}}], 
   Line3DBox[{{5, 9, 1}}], Line3DBox[{{5, 9, 2}}], Line3DBox[{{5, 9, 3}}], 
   Line3DBox[{{5, 9, 4}}], Line3DBox[{{5, 9, 5}}], Line3DBox[{{5, 9, 6}}], 
   Line3DBox[{{5, 9, 7}, {4, 8, 7}, {3, 7, 8}, {2, 6, 9}}], 
   Line3DBox[{{5, 9, 8}, {4, 8, 8}}], Line3DBox[{{5, 9, 9}}], 
   Line3DBox[{{6, 1, 1}}], Line3DBox[{{6, 1, 2}}], 
   Line3DBox[{{6, 1, 3}, {5, 2, 2}, {5, 3, 1}}], 
   Line3DBox[{{6, 1, 4}, {5, 2, 3}, {6, 3, 2}, {7, 4, 1}}], 
   Line3DBox[{{6, 1, 5}, {6, 2, 4}}], 
   Line3DBox[{{6, 1, 6}, {5, 2, 5}, {4, 3, 4}, {5, 4, 3}, {6, 5, 2}}], 
   Line3DBox[{{6, 1, 7}, {5, 2, 6}, {4, 3, 5}}], 
   Line3DBox[{{6, 1, 8}, {5, 2, 7}, {4, 3, 6}, {3, 4, 5}, {2, 5, 6}, {1, 6, 
    7}}], Line3DBox[{{6, 1, 9}, {6, 2, 8}, {5, 3, 8}, {4, 4, 9}}], 
   Line3DBox[{{6, 2, 1}}], 
   Line3DBox[{{6, 2, 9}, {6, 3, 8}, {5, 4, 7}, {4, 5, 6}, {3, 5, 5}, {2, 6, 
    4}, {3, 7, 3}, {3, 8, 2}, {4, 9, 1}}], Line3DBox[{{6, 3, 1}}], 
   Line3DBox[{{6, 3, 9}, {5, 4, 8}, {4, 5, 8}, {3, 6, 9}}], 
   Line3DBox[{{6, 4, 1}}], Line3DBox[{{6, 4, 9}, {5, 5, 8}, {4, 6, 9}}], 
   Line3DBox[{{6, 5, 1}}], Line3DBox[{{6, 5, 9}}], Line3DBox[{{6, 6, 1}}], 
   Line3DBox[{{6, 6, 9}}], Line3DBox[{{6, 7, 1}}], Line3DBox[{{6, 7, 9}}], 
   Line3DBox[{{6, 8, 1}}], Line3DBox[{{6, 8, 9}}], Line3DBox[{{6, 9, 1}}], 
   Line3DBox[{{6, 9, 2}}], Line3DBox[{{6, 9, 3}}], 
   Line3DBox[{{6, 9, 4}, {5, 8, 3}, {4, 9, 2}}], Line3DBox[{{6, 9, 5}}], 
   Line3DBox[{{6, 9, 6}, {7, 8, 7}, {8, 9, 8}, {7, 8, 8}, {6, 9, 7}, {5, 8, 
    8}, {4, 7, 8}, {5, 8, 7}, {6, 9, 8}}], 
   Line3DBox[{{6, 9, 7}, {5, 8, 8}, {4, 7, 8}, {5, 8, 7}, {6, 9, 8}}], 
   Line3DBox[{{6, 9, 8}}], Line3DBox[{{6, 9, 9}}], Line3DBox[{{7, 1, 1}}], 
   Line3DBox[{{7, 1, 2}}], Line3DBox[{{7, 1, 3}}], Line3DBox[{{7, 1, 4}}], 
   Line3DBox[{{7, 1, 5}}], Line3DBox[{{7, 1, 6}}], 
   Line3DBox[{{7, 1, 7}, {6, 2, 6}, {5, 3, 5}, {4, 4, 4}, {4, 4, 3}, {3, 5, 
    2}, {3, 6, 1}}], 
   Line3DBox[{{7, 1, 8}, {6, 2, 7}, {5, 3, 6}, {4, 4, 5}, {3, 5, 4}, {4, 6, 
    3}, {4, 7, 2}, {5, 8, 1}}], Line3DBox[{{7, 1, 9}}], 
   Line3DBox[{{7, 2, 1}}], Line3DBox[{{7, 2, 9}, {8, 3, 8}, {7, 4, 7}}], 
   Line3DBox[{{7, 3, 1}}], 
   Line3DBox[{{7, 3, 9}, {6, 4, 8}, {5, 5, 7}, {4, 6, 8}, {3, 7, 9}}], 
   Line3DBox[{{7, 4, 1}}], Line3DBox[{{7, 4, 9}, {7, 5, 8}, {6, 6, 9}}], 
   Line3DBox[{{7, 5, 1}}], Line3DBox[{{7, 5, 9}}], Line3DBox[{{7, 6, 1}}], 
   Line3DBox[{{7, 6, 9}, {8, 7, 8}, {9, 7, 7}}], Line3DBox[{{7, 7, 1}}], 
   Line3DBox[{{7, 7, 9}, {8, 8, 8}, {9, 7, 8}}], Line3DBox[{{7, 8, 1}}], 
   Line3DBox[{{7, 8, 9}}], Line3DBox[{{7, 9, 1}}], Line3DBox[{{7, 9, 2}}], 
   Line3DBox[{{7, 9, 3}}], Line3DBox[{{7, 9, 4}}], Line3DBox[{{7, 9, 5}}], 
   Line3DBox[{{7, 9, 6}}], Line3DBox[{{7, 9, 7}, {6, 8, 6}, {5, 9, 5}}], 
   Line3DBox[{{7, 9, 8}, {6, 8, 7}, {5, 7, 8}, {4, 8, 9}}], 
   Line3DBox[{{7, 9, 9}}], Line3DBox[{{8, 1, 1}}], Line3DBox[{{8, 1, 2}}], 
   Line3DBox[{{8, 1, 3}, {8, 2, 2}, {8, 2, 1}}], 
   Line3DBox[{{8, 1, 4}, {8, 2, 3}, {7, 3, 2}, {8, 4, 1}}], 
   Line3DBox[{{8, 1, 5}, {7, 2, 4}, {6, 3, 3}}], 
   Line3DBox[{{8, 1, 6}, {7, 2, 5}, {7, 3, 4}}], 
   Line3DBox[{{8, 1, 7}, {7, 2, 6}, {6, 3, 5}, {5, 4, 4}, {5, 5, 3}, {4, 6, 
    2}, {4, 6, 1}}], 
   Line3DBox[{{8, 1, 8}, {7, 2, 7}, {6, 3, 6}, {5, 4, 5}, {4, 5, 4}, {3, 6, 
    3}, {3, 7, 2}, {4, 8, 1}}], 
   Line3DBox[{{8, 1, 9}, {7, 2, 8}, {6, 3, 7}, {5, 4, 6}, {5, 5, 5}}], 
   Line3DBox[{{8, 2, 1}}], 
   Line3DBox[{{8, 2, 9}, {7, 3, 8}, {6, 4, 7}, {5, 5, 6}}], 
   Line3DBox[{{8, 3, 1}}], Line3DBox[{{8, 3, 9}}], Line3DBox[{{8, 4, 1}}], 
   Line3DBox[{{8, 4, 9}}], Line3DBox[{{8, 5, 1}}], 
   Line3DBox[{{8, 5, 9}, {8, 6, 8}, {7, 7, 8}, {6, 8, 8}, {5, 9, 7}, {4, 8, 
    7}, {3, 7, 8}, {2, 6, 9}}], Line3DBox[{{8, 6, 1}}], 
   Line3DBox[{{8, 6, 9}}], Line3DBox[{{8, 7, 1}}], Line3DBox[{{8, 7, 9}}], 
   Line3DBox[{{8, 8, 1}}], Line3DBox[{{8, 8, 9}}], Line3DBox[{{8, 9, 1}}], 
   Line3DBox[{{8, 9, 2}}], Line3DBox[{{8, 9, 3}}], Line3DBox[{{8, 9, 4}}], 
   Line3DBox[{{8, 9, 5}}], Line3DBox[{{8, 9, 6}}], Line3DBox[{{8, 9, 7}}], 
   Line3DBox[{{8, 9, 8}, {7, 8, 8}, {6, 9, 7}, {5, 8, 8}, {4, 7, 8}, {5, 8, 
    7}, {6, 9, 8}}], Line3DBox[{{8, 9, 9}}], Line3DBox[{{9, 1, 1}}], 
   Line3DBox[{{9, 1, 2}}], Line3DBox[{{9, 1, 3}}], Line3DBox[{{9, 1, 4}}], 
   Line3DBox[{{9, 1, 5}, {8, 2, 4}, {7, 3, 3}, {8, 4, 2}, {9, 5, 1}}], 
   Line3DBox[{{9, 1, 6}, {8, 2, 5}}], Line3DBox[{{9, 1, 7}}], 
   Line3DBox[{{9, 1, 8}, {8, 2, 7}, {7, 3, 6}, {6, 4, 5}, {5, 5, 4}, {5, 6, 
    3}}], Line3DBox[{{9, 1, 9}, {8, 2, 8}, {7, 3, 7}, {6, 4, 6}}], 
   Line3DBox[{{9, 2, 1}}], Line3DBox[{{9, 2, 2}}], 
   Line3DBox[{{9, 2, 3}, {8, 3, 2}, {9, 4, 1}}], 
   Line3DBox[{{9, 2, 4}, {8, 3, 3}}], 
   Line3DBox[{{9, 2, 5}, {8, 3, 4}, {8, 4, 3}, {7, 4, 2}, {8, 5, 1}}], 
   Line3DBox[{{9, 2, 6}, {8, 3, 5}, {7, 4, 4}, {6, 5, 3}, {6, 6, 2}, {5, 7, 
    1}}], Line3DBox[{{9, 2, 7}, {8, 3, 6}, {7, 4, 5}, {6, 5, 4}}], 
   Line3DBox[{{9, 2, 8}, {8, 3, 7}}], Line3DBox[{{9, 2, 9}}], 
   Line3DBox[{{9, 3, 1}}], Line3DBox[{{9, 3, 2}}], Line3DBox[{{9, 3, 3}}], 
   Line3DBox[{{9, 3, 4}}], 
   Line3DBox[{{9, 3, 5}, {8, 4, 4}, {9, 5, 3}, {8, 6, 2}, {9, 7, 1}}], 
   Line3DBox[{{9, 3, 6}, {8, 4, 5}, {7, 5, 4}}], 
   Line3DBox[{{9, 3, 7}, {8, 2, 6}, {7, 3, 5}, {6, 4, 4}, {7, 5, 3}, {7, 6, 
    2}, {7, 7, 1}}], 
   Line3DBox[{{9, 3, 8}, {8, 4, 7}, {7, 4, 6}, {6, 5, 5}, {5, 6, 4}}], 
   Line3DBox[{{9, 3, 9}, {8, 4, 8}, {7, 5, 7}}], Line3DBox[{{9, 4, 1}}], 
   Line3DBox[{{9, 4, 2}}], Line3DBox[{{9, 4, 3}}], 
   Line3DBox[{{9, 4, 4}, {8, 5, 3}, {9, 6, 2}}], 
   Line3DBox[{{9, 4, 5}, {8, 5, 4}, {7, 6, 3}, {6, 7, 2}, {6, 8, 1}}], 
   Line3DBox[{{9, 4, 6}, {8, 5, 5}, {7, 6, 4}}], 
   Line3DBox[{{9, 4, 7}, {8, 4, 6}, {7, 5, 5}}], 
   Line3DBox[{{9, 4, 8}, {8, 5, 7}, {7, 6, 6}, {6, 7, 5}, {5, 7, 4}, {4, 6, 
    5}}], Line3DBox[{{9, 4, 9}, {8, 5, 8}, {7, 6, 7}, {6, 6, 7}, {5, 6, 7}}], 
   Line3DBox[{{9, 5, 1}}], Line3DBox[{{9, 5, 2}}], 
   Line3DBox[{{9, 5, 3}, {8, 6, 2}, {9, 7, 1}}], Line3DBox[{{9, 5, 4}}], 
   Line3DBox[{{9, 5, 5}, {8, 6, 5}, {7, 7, 4}, {6, 6, 3}, {5, 7, 2}, {6, 8, 
    2}, {5, 9, 1}}], Line3DBox[{{9, 5, 6}}], 
   Line3DBox[{{9, 5, 7}, {8, 6, 6}, {7, 7, 6}, {6, 8, 5}, {5, 8, 4}, {4, 8, 
    3}, {5, 9, 2}}], Line3DBox[{{9, 5, 8}, {8, 6, 7}}], 
   Line3DBox[{{9, 5, 9}}], Line3DBox[{{9, 6, 1}}], Line3DBox[{{9, 6, 2}}], 
   Line3DBox[{{9, 6, 3}}], 
   Line3DBox[{{9, 6, 4}, {8, 7, 3}, {8, 8, 2}, {7, 9, 1}}], 
   Line3DBox[{{9, 6, 5}, {8, 7, 4}, {7, 8, 3}, {7, 9, 2}}], 
   Line3DBox[{{9, 6, 6}}], 
   Line3DBox[{{9, 6, 7}, {8, 7, 7}, {7, 8, 6}, {6, 9, 5}}], 
   Line3DBox[{{9, 6, 8}}], Line3DBox[{{9, 6, 9}}], Line3DBox[{{9, 7, 1}}], 
   Line3DBox[{{9, 7, 2}}], Line3DBox[{{9, 7, 3}}], 
   Line3DBox[{{9, 7, 4}, {8, 8, 3}, {8, 9, 2}}], 
   Line3DBox[{{9, 7, 5}, {8, 6, 4}}], 
   Line3DBox[{{9, 7, 6}, {8, 7, 5}, {7, 8, 4}, {6, 9, 3}}], 
   Line3DBox[{{9, 7, 7}}], Line3DBox[{{9, 7, 8}}], Line3DBox[{{9, 7, 9}}], 
   Line3DBox[{{9, 8, 1}}], Line3DBox[{{9, 8, 2}}], Line3DBox[{{9, 8, 3}}], 
   Line3DBox[{{9, 8, 4}}], Line3DBox[{{9, 8, 5}, {8, 8, 4}, {7, 9, 3}}], 
   Line3DBox[{{9, 8, 6}}], 
   Line3DBox[{{9, 8, 7}, {8, 7, 6}, {7, 7, 5}, {6, 8, 4}, {5, 9, 3}}], 
   Line3DBox[{{9, 8, 8}, {8, 8, 7}}], Line3DBox[{{9, 8, 9}}], 
   Line3DBox[{{9, 9, 1}}], Line3DBox[{{9, 9, 2}}], Line3DBox[{{9, 9, 3}}], 
   Line3DBox[{{9, 9, 4}}], Line3DBox[{{9, 9, 5}}], 
   Line3DBox[{{9, 9, 6}, {8, 8, 5}, {7, 9, 4}}], 
   Line3DBox[{{9, 9, 7}, {8, 8, 6}, {7, 8, 5}, {6, 9, 4}, {5, 8, 3}, {4, 9, 
    2}}], Line3DBox[{{9, 9, 8}}], Line3DBox[{{9, 9, 9}}]},
  AutomaticImageSize->True,
  ImageSize->{399.6169673172362, 417.86057334282924`},
  ViewPoint->{1.110651458879143, 0.5553583591660493, 3.1477024048969473`},
  ViewVertical->{-0.5203804009870284, -0.13612576015439823`, 
   0.843014837171308}]], "Output",
 CellChangeTimes->{{3.6387287988712893`*^9, 3.6387288070227556`*^9}, 
   3.6387288498602057`*^9, 3.6387290471694913`*^9, {3.638729104790787*^9, 
   3.6387291218597636`*^9}, 3.638729226681759*^9, 3.6387292710792985`*^9, 
   3.638729364047616*^9, 3.638729483257434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics3D", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Thickness", "\[Rule]", "0.005"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"LongFibers", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "LongFibers", "]"}]}], "}"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6387295024445314`*^9, 3.6387295065867686`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {Thickness[0.005], 
   Line3DBox[{{1, 6, 7}, {2, 5, 6}, {3, 4, 5}, {4, 3, 6}, {5, 2, 7}, {6, 1, 
    8}}], Line3DBox[{{2, 2, 1}, {2, 3, 2}, {3, 4, 1}, {4, 3, 2}, {3, 2, 3}, {
    4, 1, 4}}], 
   Line3DBox[{{2, 6, 9}, {3, 7, 8}, {4, 8, 7}, {5, 9, 7}, {6, 8, 8}, {7, 7, 
    8}, {8, 6, 8}, {8, 5, 9}}], 
   Line3DBox[{{2, 8, 1}, {2, 7, 2}, {2, 6, 3}, {2, 5, 2}, {1, 4, 2}, {2, 3, 
    3}, {2, 2, 4}, {2, 1, 5}}], 
   Line3DBox[{{3, 6, 1}, {3, 5, 2}, {4, 4, 3}, {4, 4, 4}, {5, 3, 5}, {6, 2, 
    6}, {7, 1, 7}}], 
   Line3DBox[{{3, 9, 1}, {4, 8, 2}, {3, 8, 3}, {3, 7, 4}, {2, 6, 5}, {1, 7, 
    5}}], Line3DBox[{{4, 6, 1}, {4, 6, 2}, {5, 5, 3}, {5, 4, 4}, {6, 3, 5}, {
    7, 2, 6}, {8, 1, 7}}], 
   Line3DBox[{{4, 7, 1}, {3, 6, 2}, {2, 5, 3}, {3, 4, 4}, {3, 3, 5}, {4, 2, 
    6}, {5, 1, 7}, {4, 2, 7}, {3, 3, 8}, {4, 2, 8}, {5, 1, 8}}], 
   Line3DBox[{{4, 8, 1}, {3, 7, 2}, {3, 6, 3}, {4, 5, 4}, {5, 4, 5}, {6, 3, 
    6}, {7, 2, 7}, {8, 1, 8}}], 
   Line3DBox[{{4, 9, 1}, {3, 8, 2}, {3, 7, 3}, {2, 6, 4}, {3, 5, 5}, {4, 5, 
    6}, {5, 4, 7}, {6, 3, 8}, {6, 2, 9}}], 
   Line3DBox[{{4, 9, 2}, {5, 8, 3}, {6, 9, 4}, {7, 8, 5}, {8, 8, 6}, {9, 9, 
    7}}], Line3DBox[{{5, 6, 1}, {4, 5, 2}, {3, 4, 3}, {3, 3, 3}, {3, 2, 4}, {
    3, 1, 5}}], 
   Line3DBox[{{5, 7, 1}, {6, 6, 2}, {6, 5, 3}, {7, 4, 4}, {8, 3, 5}, {9, 2, 
    6}}], Line3DBox[{{5, 8, 1}, {4, 7, 2}, {4, 6, 3}, {3, 5, 4}, {4, 4, 5}, {
    5, 3, 6}, {6, 2, 7}, {7, 1, 8}}], 
   Line3DBox[{{5, 9, 1}, {6, 8, 2}, {5, 7, 2}, {6, 6, 3}, {7, 7, 4}, {8, 6, 
    5}, {9, 5, 5}}], 
   Line3DBox[{{5, 9, 2}, {4, 8, 3}, {5, 8, 4}, {6, 8, 5}, {7, 7, 6}, {8, 6, 
    6}, {9, 5, 7}}], 
   Line3DBox[{{6, 4, 1}, {7, 5, 2}, {7, 4, 3}, {6, 3, 4}, {6, 2, 5}, {5, 1, 
    6}}], Line3DBox[{{6, 9, 1}, {5, 8, 2}, {5, 7, 3}, {4, 6, 4}, {3, 6, 5}, {
    4, 7, 4}, {3, 7, 5}}], 
   Line3DBox[{{6, 9, 8}, {5, 8, 7}, {4, 7, 8}, {5, 8, 8}, {6, 9, 7}, {7, 8, 
    8}, {8, 9, 8}, {7, 8, 7}, {6, 9, 6}}], 
   Line3DBox[{{7, 7, 1}, {7, 6, 2}, {7, 5, 3}, {6, 4, 4}, {7, 3, 5}, {8, 2, 
    6}, {9, 3, 7}}], 
   Line3DBox[{{1, 7, 5}, {2, 6, 5}, {3, 7, 4}, {3, 8, 3}, {4, 8, 2}, {3, 9, 
    1}}], Line3DBox[{{2, 1, 5}, {2, 2, 4}, {2, 3, 3}, {1, 4, 2}, {2, 5, 2}, {
    2, 6, 3}, {2, 7, 2}, {2, 8, 1}}], 
   Line3DBox[{{3, 1, 5}, {3, 2, 4}, {3, 3, 3}, {3, 4, 3}, {4, 5, 2}, {5, 6, 
    1}}], Line3DBox[{{4, 1, 4}, {3, 2, 3}, {4, 3, 2}, {3, 4, 1}, {2, 3, 2}, {
    2, 2, 1}}], 
   Line3DBox[{{5, 1, 6}, {6, 2, 5}, {6, 3, 4}, {7, 4, 3}, {7, 5, 2}, {6, 4, 
    1}}], Line3DBox[{{5, 1, 7}, {4, 2, 6}, {3, 3, 5}, {3, 4, 4}, {2, 5, 3}, {
    3, 6, 2}, {4, 7, 1}}], 
   Line3DBox[{{5, 1, 8}, {4, 2, 8}, {3, 3, 8}, {4, 2, 7}, {5, 1, 7}, {4, 2, 
    6}, {3, 3, 5}, {3, 4, 4}, {2, 5, 3}, {3, 6, 2}, {4, 7, 1}}], 
   Line3DBox[{{6, 1, 8}, {5, 2, 7}, {4, 3, 6}, {3, 4, 5}, {2, 5, 6}, {1, 6, 
    7}}], Line3DBox[{{6, 2, 9}, {6, 3, 8}, {5, 4, 7}, {4, 5, 6}, {3, 5, 5}, {
    2, 6, 4}, {3, 7, 3}, {3, 8, 2}, {4, 9, 1}}], 
   Line3DBox[{{6, 9, 6}, {7, 8, 7}, {8, 9, 8}, {7, 8, 8}, {6, 9, 7}, {5, 8, 
    8}, {4, 7, 8}, {5, 8, 7}, {6, 9, 8}}], 
   Line3DBox[{{7, 1, 7}, {6, 2, 6}, {5, 3, 5}, {4, 4, 4}, {4, 4, 3}, {3, 5, 
    2}, {3, 6, 1}}], 
   Line3DBox[{{7, 1, 8}, {6, 2, 7}, {5, 3, 6}, {4, 4, 5}, {3, 5, 4}, {4, 6, 
    3}, {4, 7, 2}, {5, 8, 1}}], 
   Line3DBox[{{8, 1, 7}, {7, 2, 6}, {6, 3, 5}, {5, 4, 4}, {5, 5, 3}, {4, 6, 
    2}, {4, 6, 1}}], 
   Line3DBox[{{8, 1, 8}, {7, 2, 7}, {6, 3, 6}, {5, 4, 5}, {4, 5, 4}, {3, 6, 
    3}, {3, 7, 2}, {4, 8, 1}}], 
   Line3DBox[{{8, 5, 9}, {8, 6, 8}, {7, 7, 8}, {6, 8, 8}, {5, 9, 7}, {4, 8, 
    7}, {3, 7, 8}, {2, 6, 9}}], 
   Line3DBox[{{8, 9, 8}, {7, 8, 8}, {6, 9, 7}, {5, 8, 8}, {4, 7, 8}, {5, 8, 
    7}, {6, 9, 8}}], 
   Line3DBox[{{9, 1, 8}, {8, 2, 7}, {7, 3, 6}, {6, 4, 5}, {5, 5, 4}, {5, 6, 
    3}}], Line3DBox[{{9, 2, 6}, {8, 3, 5}, {7, 4, 4}, {6, 5, 3}, {6, 6, 2}, {
    5, 7, 1}}], 
   Line3DBox[{{9, 3, 7}, {8, 2, 6}, {7, 3, 5}, {6, 4, 4}, {7, 5, 3}, {7, 6, 
    2}, {7, 7, 1}}], 
   Line3DBox[{{9, 4, 8}, {8, 5, 7}, {7, 6, 6}, {6, 7, 5}, {5, 7, 4}, {4, 6, 
    5}}], 
   Line3DBox[{{9, 5, 5}, {8, 6, 5}, {7, 7, 4}, {6, 6, 3}, {5, 7, 2}, {6, 8, 
    2}, {5, 9, 1}}], 
   Line3DBox[{{9, 5, 7}, {8, 6, 6}, {7, 7, 6}, {6, 8, 5}, {5, 8, 4}, {4, 8, 
    3}, {5, 9, 2}}], 
   Line3DBox[{{9, 9, 7}, {8, 8, 6}, {7, 8, 5}, {6, 9, 4}, {5, 8, 3}, {4, 9, 
    2}}]},
  AutomaticImageSize->True,
  ImageSize->{320.5983545838004, 352.2556898605611},
  ViewPoint->{0.8037023196457905, -2.9529188827026926`, 1.4437218061572177`},
  ViewVertical->{0.031154685803068224`, -0.18895184631561568`, 
   0.9814920200014018}]], "Output",
 CellChangeTimes->{3.6387295077088327`*^9}]
}, Open  ]]
},
WindowSize->{1179, 899},
WindowMargins->{{552, Automatic}, {Automatic, -945}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2385, 59, 112, "Input"],
Cell[2968, 83, 161, 3, 31, "Output"]
}, Open  ]],
Cell[3144, 89, 311, 7, 52, "Input"],
Cell[3458, 98, 6521, 158, 612, "Input"],
Cell[9982, 258, 7503, 184, 525, "Input"],
Cell[17488, 444, 8551, 196, 1092, "Input"],
Cell[26042, 642, 2750, 67, 312, "Input"],
Cell[CellGroupData[{
Cell[28817, 713, 299, 6, 31, "Input"],
Cell[29119, 721, 2421, 51, 236, "Output"]
}, Open  ]],
Cell[31555, 775, 2436, 56, 332, "Input"],
Cell[33994, 833, 2254, 58, 52, "Input"],
Cell[CellGroupData[{
Cell[36273, 895, 1770, 47, 172, "Input"],
Cell[38046, 944, 28432, 438, 433, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66515, 1387, 557, 14, 72, "Input"],
Cell[67075, 1403, 4659, 84, 367, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
